<<<<<<< HEAD
{"version":3,"sources":["webpack:///webpack/bootstrap 761d7e939dcf3e7e9242","webpack:///./src/ParticleEngine/ParticleEngine.js","webpack:///./src/index.js","webpack:///./src/shaders/phong.js","webpack:///./src/ParticleEngine/ParticleEngineExamples.js","webpack:///./node_modules/util/util.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/util/support/isBufferBrowser.js","webpack:///./node_modules/util/node_modules/inherits/inherits_browser.js"],"names":["particleVertexShader","particleFragmentShader","Tween","timeArray","valueArray","times","values","prototype","constructor","lerp","t","i","n","length","p","THREE","Vector3","clone","ntimes","slice","nvalues","Particle","position","velocity","acceleration","angle","angleVelocity","angleAcceleration","size","color","Color","opacity","age","alive","update","dt","add","multiplyScalar","sizeTween","colorTween","colorHSL","setHSL","x","y","z","opacityTween","Type","Object","freeze","ParticleEngine","positionStyle","CUBE","positionBase","positionSpread","positionRadius","velocityStyle","velocityBase","velocitySpread","speedBase","speedSpread","accelerationBase","accelerationSpread","angleBase","angleSpread","angleVelocityBase","angleVelocitySpread","angleAccelerationBase","angleAccelerationSpread","sizeBase","sizeSpread","colorBase","colorSpread","opacityBase","opacitySpread","blendStyle","NormalBlending","particleArray","particlesPerSecond","particleDeathAge","emitterAge","emitterAlive","emitterDeathAge","particleCount","Math","min","particleGeometry","BufferGeometry","particleTexture","particleMaterial","ShaderMaterial","uniforms","texture","type","value","vertexShader","fragmentShader","transparent","alphaTest","blending","depthTest","particleMesh","Mesh","lastIndex","setValues","parameters","undefined","key","Points","randomValue","base","spread","random","randomVector3","rand3","addVectors","multiplyVectors","createParticle","particle","SPHERE","r","sqrt","vec3","cos","sin","direction","subVectors","speed","normalize","initialize","geovertices","geocustomvisible","geocustomcolor","geocustomopacity","geocustomsize","geocustomangle","concat","push","g","b","addAttribute","BufferAttribute","Float32Array","depthWrite","dynamic","sortParticles","floor","endIndex","recycleIndices","attributes","array","customVisible","customColor","customOpacity","customSize","customAngle","needsUpdate","j","destroy","container","stats","camera","scene","renderer","controls","ambientLight","directionalLight","spotLight","pointLight","planeuniform","verticalMirror","spotLight2","miku","stage","window","particleEngine","spotlightHelper2","spotLightHelper","pointLightHelper","SHADOW_MAP_WIDTH","SHADOW_MAP_HEIGHT","SCREEN_WIDTH","innerWidth","SCREEN_HEIGHT","innerHeight","NEAR","FAR","init","animate","Scene","background","document","createElement","body","appendChild","PerspectiveCamera","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","PCFShadowMap","domElement","OrbitControls","addEventListener","render","minDistance","maxDistance","enablePan","AmbientLight","DirectionalLight","copy","target","Object3D","PointLight","set","castShadow","sphereSize","PointLightHelper","visible","SpotLight","PI","penumbra","decay","distance","shadow","mapSize","width","height","near","far","textureLoader","TextureLoader","load","material","MeshBasicMaterial","map","AdditiveBlending","geometry","BoxGeometry","cube","receiveShadow","xhr","console","error","Loader","Handlers","DDSLoader","mtlLoader","MTLLoader","setPath","materials","preload","objLoader","OBJLoader","setMaterials","object","traverse","node","scale","initGUI","log","SpotLightHelper","huajiTexture","backboardTex","shader","ShaderLib","UniformsUtils","m","phong","frag","vert","lights","box","BoxBufferGeometry","particleSystem","Matrix4","planegeo","PlaneBufferGeometry","planemtl","plane","targetObject","updateMatrixWorld","textureMatrixProj","makeProjectiveMatrixForLight","onWindowResize","Reflector","clipBias","textureWidth","textureHeight","recursion","rotateY","aspect","updateProjectionMatrix","lastTime","time","requestAnimationFrame","delta","l","lightCamera","lightMatrix","targetPosition","setFromMatrixPosition","matrixWorld","lookAt","matrixWorldInverse","getInverse","multiply","projectionMatrix","gui","dat","GUI","folder","addFolder","shadingConf","onChange","MeshPhongMaterial","flatShading","k","directionalLightConf","getStyle","addColor","setStyle","pointLightConf","spotLightConf","ShadowMapConf","ShadowMapType","max","step","clearTarget","ProjectiveTextureConf","blendingParam","showMapTexture","MirrorConf","mirror","HelperConf","spotLightHelper1","spotLightHelper2","effectName","example","paras","getEffect","path","particleTexturePath","loader","_texture","group","Group","loaded","total","warn","examples","smoke","clouds","snow","rain","candle","cloneExamples","dst","u","Array","String","Number","Examples","exist","effect","destruct","dispose"],"mappings":"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AO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,KAAK;;AAEjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,mCAAmC,OAAO;AAC1C;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;ACzkBA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;ACpBA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;ACvLtC;AACA;AACA;AACA;AACA;AACA,C;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index_bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 761d7e939dcf3e7e9242","/**\n* @author Lee Stemkoski   http://www.adelphi.edu/~stemkoski/\n*/\n\n/// /// /// /// /\n// SHADERS //\n/// /// /// /// /\n\n// attribute: data that may be different for each particle (such as size and color)\n//      can only be used in vertex shader\n// varying: used to communicate data from vertex shader to fragment shader\n// uniform: data that is the same for each particle (such as texture)\n\nvar particleVertexShader =\n`\nattribute vec3  customColor;\nattribute float customOpacity;\nattribute float customSize;\nattribute float customAngle;\nattribute float customVisible; // float used as boolean (0 = false, 1 = true)\nvarying vec4  vColor;\nvarying float vAngle;\n\nvoid main()\n{\n  if ( customVisible > 0.5 ) { // true\n    vColor = vec4( customColor, customOpacity ); // set color associated to vertex use later in fragment shader.\n  } else { // false\n    vColor = vec4(0.0, 0.0, 0.0, 0.0); // make particle invisible.\n  }\n  vAngle = customAngle;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n  gl_PointSize = customSize * ( ( 1.0 / 200000.0 ) / length(cameraPosition.xyz - mvPosition.xyz) ); // scale particles as objects in 3D space\n  gl_Position = projectionMatrix * mvPosition;\n}\n`\nvar particleFragmentShader =\n`\nuniform sampler2D texture;\nvarying vec4 vColor;\nvarying float vAngle;\nvoid main()\n{\n  gl_FragColor = vColor;\n\n  float c = cos(vAngle);\n  float s = sin(vAngle);\n  vec2 rotatedUV = vec2(\n    c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\n    c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5\n  );  // rotate UV coordinates to rotate texture\n  vec4 rotatedTexture = texture2D( texture,  rotatedUV );\n  gl_FragColor = gl_FragColor * rotatedTexture;    // sets an otherwise white particle texture to desired color\n}\n`\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// //\n// TWEEN CLASS //\n/// /// /// /// /// //\n\nvar Tween = function (timeArray, valueArray) {\n  this.times = timeArray || []\n  this.values = valueArray || []\n}\n\nTween.prototype.constructor = Tween\n\nTween.prototype.lerp = function (t) {\n  var i = 0\n  var n = this.times.length\n  while (i < n && t > this.times[i]) {\n    i++\n  }\n  if (i === 0) return this.values[0]\n  if (i === n) return this.values[n - 1]\n  var p = (t - this.times[i - 1]) / (this.times[i] - this.times[i - 1])\n  if (this.values[0] instanceof THREE.Vector3) {\n    return this.values[i - 1].clone().lerp(this.values[i], p)\n  } else { // its a float\n    return this.values[i - 1] + p * (this.values[i] - this.values[i - 1])\n  }\n}\n\nTween.prototype.clone = function () {\n  let ntimes = this.times.slice()\n  let nvalues = this.values.slice()\n  return new this.constructor(ntimes, nvalues)\n}\n\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// /// //\n// PARTICLE CLASS //\n/// /// /// /// /// /// //\n\nvar Particle = function () {\n  this.position = new THREE.Vector3()\n  this.velocity = new THREE.Vector3() // units per second\n  this.acceleration = new THREE.Vector3()\n\n  this.angle = 0\n  this.angleVelocity = 0 // degrees per second\n  this.angleAcceleration = 0 // degrees per second, per second\n\n  this.size = 16.0\n\n  this.color = new THREE.Color()\n  this.opacity = 1.0\n\n  this.age = 0\n  this.alive = 0 // use float instead of boolean for shader purposes\n}\n\nParticle.prototype.constructor = Particle\n\nParticle.prototype.update = function (dt) {\n  this.position.add(this.velocity.clone().multiplyScalar(dt))\n  this.velocity.add(this.acceleration.clone().multiplyScalar(dt))\n\n  // convert from degrees to radians: 0.01745329251 = Math.PI/180\n  this.angle += this.angleVelocity * 0.01745329251 * dt\n  this.angleVelocity += this.angleAcceleration * 0.01745329251 * dt\n\n  this.age += dt\n\n  // if the tween for a given attribute is nonempty,\n  //  then use it to update the attribute's value\n\n  if (this.sizeTween.times.length > 0) {\n    this.size = this.sizeTween.lerp(this.age)\n  }\n\n  if (this.colorTween.times.length > 0) {\n    var colorHSL = this.colorTween.lerp(this.age)\n    this.color = new THREE.Color().setHSL(colorHSL.x, colorHSL.y, colorHSL.z)\n  }\n\n  if (this.opacityTween.times.length > 0) {\n    this.opacity = this.opacityTween.lerp(this.age)\n  }\n}\n\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// /// /// /// ///\n// PARTICLE ENGINE CLASS //\n/// /// /// /// /// /// /// /// ///\n\nvar Type = Object.freeze({ 'CUBE': 1, 'SPHERE': 2 })\n\nvar ParticleEngine = function () {\n  /// /// /// /// /// /// /// /// /\n  // PARTICLE PROPERTIES //\n  /// /// /// /// /// /// /// /// /\n\n  this.positionStyle = Type.CUBE\n  this.positionBase = new THREE.Vector3()\n  // cube shape data\n  this.positionSpread = new THREE.Vector3()\n  // sphere shape data\n  this.positionRadius = 0 // distance from base at which particles start\n\n  this.velocityStyle = Type.CUBE\n  // cube movement data\n  this.velocityBase = new THREE.Vector3()\n  this.velocitySpread = new THREE.Vector3()\n  // sphere movement data\n  //   direction vector calculated using initial position\n  this.speedBase = 0\n  this.speedSpread = 0\n\n  this.accelerationBase = new THREE.Vector3()\n  this.accelerationSpread = new THREE.Vector3()\n\n  this.angleBase = 0\n  this.angleSpread = 0\n  this.angleVelocityBase = 0\n  this.angleVelocitySpread = 0\n  this.angleAccelerationBase = 0\n  this.angleAccelerationSpread = 0\n\n  this.sizeBase = 0.0\n  this.sizeSpread = 0.0\n  this.sizeTween = new Tween()\n\n  // store colors in HSL format in a THREE.THREE.Vector3 object\n  // http://en.wikipedia.org/wiki/HSL_and_HSV\n  this.colorBase = new THREE.Vector3(0.0, 1.0, 0.5)\n  this.colorSpread = new THREE.Vector3(0.0, 0.0, 0.0)\n  this.colorTween = new Tween()\n\n  this.opacityBase = 1.0\n  this.opacitySpread = 0.0\n  this.opacityTween = new Tween()\n\n  this.blendStyle = THREE.NormalBlending // false\n\n  this.particleArray = []\n  this.particlesPerSecond = 100\n  this.particleDeathAge = 1.0\n\n  /// /// /// /// /// /// /// ///\n  // EMITTER PROPERTIES //\n  /// /// /// /// /// /// /// ///\n\n  this.emitterAge = 0.0\n  this.emitterAlive = true\n  this.emitterDeathAge = 60 // time (seconds) at which to stop creating particles.\n\n  // How many particles could be active at any time?\n  this.particleCount = this.particlesPerSecond * Math.min(this.particleDeathAge, this.emitterDeathAge)\n\n  /// /// /// /// //\n  // THREE.JS //\n  /// /// /// /// //\n\n  this.particleGeometry = new THREE.BufferGeometry()\n  this.particleTexture = null\n  this.particleMaterial = new THREE.ShaderMaterial(\n    {\n      uniforms:\n      {\n        texture: { type: 't', value: this.particleTexture }\n      },\n      vertexShader: particleVertexShader,\n      fragmentShader: particleFragmentShader,\n      transparent: true,\n      alphaTest: 0.5,\n      // if having transparency issues, try including: alphaTest: 0.5\n      blending: THREE.NormalBlending,\n      depthTest: true\n    })\n  this.particleMesh = new THREE.Mesh()\n\n  this.lastIndex = -1\n}\n\nParticleEngine.prototype.constructor = ParticleEngine\n\nParticleEngine.prototype.setValues = function (parameters) {\n  if (parameters === undefined) return\n\n  // clear any previous tweens that might exist\n  this.sizeTween = new Tween()\n  this.colorTween = new Tween()\n  this.opacityTween = new Tween()\n\n  for (var key in parameters) {\n    this[key] = parameters[key]\n  }\n\n  // calculate/set derived particle engine values\n  this.particleArray = []\n  this.emitterAge = 0.0\n  this.emitterAlive = true\n  this.particleCount = this.particlesPerSecond * Math.min(this.particleDeathAge, this.emitterDeathAge)\n\n  this.particleGeometry = new THREE.BufferGeometry()\n  this.particleMaterial = new THREE.ShaderMaterial(\n    {\n      uniforms:\n      {\n        texture: { type: 't', value: parameters.particleTexture }\n      },\n      vertexShader: particleVertexShader,\n      fragmentShader: particleFragmentShader,\n      transparent: true,\n      alphaTest: 0.5,\n      // if having transparency issues, try including: alphaTest: 0.5,\n      blending: THREE.NormalBlending,\n      depthTest: true\n    })\n  this.particleMesh = new THREE.Points()\n}\n\n// helper functions for randomization\nParticleEngine.prototype.randomValue = function (base, spread) {\n  return base + spread * (Math.random() - 0.5)\n}\nParticleEngine.prototype.randomVector3 = function (base, spread) {\n  var rand3 = new THREE.Vector3(Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5)\n  return new THREE.Vector3().addVectors(base, new THREE.Vector3().multiplyVectors(spread, rand3))\n}\n\nParticleEngine.prototype.createParticle = function () {\n  var particle = new Particle()\n\n  particle.sizeTween = this.sizeTween\n  particle.colorTween = this.colorTween\n  particle.opacityTween = this.opacityTween\n\n  if (this.positionStyle === Type.CUBE) {\n    particle.position = this.randomVector3(this.positionBase, this.positionSpread)\n  }\n  if (this.positionStyle === Type.SPHERE) {\n    var z = 2 * Math.random() - 1\n    var t = 6.2832 * Math.random()\n    var r = Math.sqrt(1 - z * z)\n    var vec3 = new THREE.Vector3(r * Math.cos(t), r * Math.sin(t), z)\n    particle.position = new THREE.Vector3().addVectors(this.positionBase, vec3.multiplyScalar(this.positionRadius))\n  }\n\n  if (this.velocityStyle === Type.CUBE) {\n    particle.velocity = this.randomVector3(this.velocityBase, this.velocitySpread)\n  }\n  if (this.velocityStyle === Type.SPHERE) {\n    var direction = new THREE.Vector3().subVectors(particle.position, this.positionBase)\n    var speed = this.randomValue(this.speedBase, this.speedSpread)\n    particle.velocity = direction.normalize().multiplyScalar(speed)\n  }\n\n  particle.acceleration = this.randomVector3(this.accelerationBase, this.accelerationSpread)\n\n  particle.angle = this.randomValue(this.angleBase, this.angleSpread)\n  particle.angleVelocity = this.randomValue(this.angleVelocityBase, this.angleVelocitySpread)\n  particle.angleAcceleration = this.randomValue(this.angleAccelerationBase, this.angleAccelerationSpread)\n\n  particle.size = this.randomValue(this.sizeBase, this.sizeSpread)\n\n  var color = this.randomVector3(this.colorBase, this.colorSpread)\n  particle.color = new THREE.Color().setHSL(color.x, color.y, color.z)\n\n  particle.opacity = this.randomValue(this.opacityBase, this.opacitySpread)\n\n  particle.age = 0\n  particle.alive = 0 // particles initialize as inactive\n  // console.log('[ParticleEngine] createParticle', particle)\n  return particle\n}\n\nParticleEngine.prototype.initialize = function () {\n  // link particle data with geometry/material data\n  let geovertices = []\n  let geocustomvisible = []\n  let geocustomcolor = []\n  let geocustomopacity = []\n  let geocustomsize = []\n  let geocustomangle = []\n  for (var i = 0; i < this.particleCount; i++) {\n    // remove duplicate code somehow, here and in update function below.\n    this.particleArray[i] = this.createParticle()\n    geovertices = geovertices.concat([this.particleArray[i].position.x, this.particleArray[i].position.y, this.particleArray[i].position.z])\n    geocustomvisible.push(this.particleArray[i].alive)\n    geocustomcolor = geocustomcolor.concat([this.particleArray[i].color.r, this.particleArray[i].color.g, this.particleArray[i].color.b])\n    geocustomopacity.push(this.particleArray[i].opacity)\n    geocustomsize.push(this.particleArray[i].size)\n    geocustomangle.push(this.particleArray[i].angle)\n  }\n  this.particleGeometry.addAttribute('position', new  THREE.BufferAttribute(new Float32Array(geovertices), 3))\n  this.particleGeometry.addAttribute('customVisible', new THREE.BufferAttribute(new Float32Array(geocustomvisible), 1))\n  this.particleGeometry.addAttribute('customColor', new THREE.BufferAttribute(new Float32Array(geocustomcolor), 3))\n  this.particleGeometry.addAttribute('customOpacity', new THREE.BufferAttribute(new Float32Array(geocustomopacity), 1))\n  this.particleGeometry.addAttribute('customSize', new  THREE.BufferAttribute(new Float32Array(geocustomsize), 1))\n  this.particleGeometry.addAttribute('customAngle', new THREE.BufferAttribute(new Float32Array(geocustomangle), 1))\n\n  this.particleMaterial.blending = this.blendStyle\n  this.particleMaterial.depthWrite = false\n  // if (this.blendStyle !== NormalBlending) {\n  //   this.particleMaterial.depthWrite = false\n  // }\n\n  this.particleMesh = new THREE.Points(this.particleGeometry, this.particleMaterial)\n  this.particleMesh.dynamic = true\n  this.particleMesh.sortParticles = true\n  // scene.add(this.particleMesh)\n}\n\nParticleEngine.prototype.update = function (dt) {\n  // determine indices of particles to activate\n  if (this.lastIndex === -1) this.lastIndex = Math.floor(this.particlesPerSecond * (this.emitterAge + 0))\n  if (this.lastIndex < this.particleCount) {\n    var endIndex = Math.floor(this.particlesPerSecond * (this.emitterAge + dt))\n    if (endIndex > this.particleCount) endIndex = this.particleCount\n    for (let i = this.lastIndex; i < endIndex; ++i) {\n      this.particleArray[i].alive = 1.0\n    }\n    this.lastIndex = endIndex\n  }\n\n  var recycleIndices = []\n\n  // update particle data\n  for (var i = 0; i < this.particleCount; i++) {\n    if (this.particleArray[i].alive === 1.0) {\n      this.particleArray[i].update(dt)\n\n      // check if particle should expire\n      // could also use: death by size<0 or alpha<0.\n      if (this.particleArray[i].age > this.particleDeathAge) {\n        this.particleArray[i].alive = 0.0\n        recycleIndices.push(i)\n      }\n      // update particle properties in shader\n      this.particleGeometry.attributes.position.array[i * 3] = this.particleArray[i].position.x\n      this.particleGeometry.attributes.position.array[i * 3 + 1] = this.particleArray[i].position.y\n      this.particleGeometry.attributes.position.array[i * 3 + 2] = this.particleArray[i].position.z\n\n      this.particleGeometry.attributes.customVisible.array[i] = this.particleArray[i].alive\n      this.particleGeometry.attributes.customColor.array[i * 3] = this.particleArray[i].color.r\n      this.particleGeometry.attributes.customColor.array[i * 3 + 1] = this.particleArray[i].color.g\n      this.particleGeometry.attributes.customColor.array[i * 3 + 2] = this.particleArray[i].color.b\n      this.particleGeometry.attributes.customOpacity.array[i] = this.particleArray[i].opacity\n      this.particleGeometry.attributes.customSize.array[i] = this.particleArray[i].size\n      this.particleGeometry.attributes.customAngle.array[i] = this.particleArray[i].angle\n    }\n  }\n\n  this.particleGeometry.attributes.position.needsUpdate = true\n  this.particleGeometry.attributes.customVisible.needsUpdate = true\n  this.particleGeometry.attributes.customColor.needsUpdate = true\n  this.particleGeometry.attributes.customOpacity.needsUpdate = true\n  this.particleGeometry.attributes.customSize.needsUpdate = true\n  this.particleGeometry.attributes.customAngle.needsUpdate = true\n\n  // check if particle emitter is still running\n  if (!this.emitterAlive) return\n\n  // if any particles have died while the emitter is still running, we imediately recycle them\n  for (var j = 0; j < recycleIndices.length; j++) {\n    let i = recycleIndices[j]\n    this.particleArray[i] = this.createParticle()\n    this.particleArray[i].alive = 1.0 // activate right away\n    this.particleArray[i].update(dt)\n    this.particleGeometry.attributes.position.array[i * 3] = this.particleArray[i].position.x\n    this.particleGeometry.attributes.position.array[i * 3 + 1] = this.particleArray[i].position.y\n    this.particleGeometry.attributes.position.array[i * 3 + 2] = this.particleArray[i].position.z\n\n    this.particleGeometry.attributes.customVisible.array[i] = this.particleArray[i].alive\n    this.particleGeometry.attributes.customColor.array[i * 3] = this.particleArray[i].color.r\n    this.particleGeometry.attributes.customColor.array[i * 3 + 1] = this.particleArray[i].color.g\n    this.particleGeometry.attributes.customColor.array[i * 3 + 2] = this.particleArray[i].color.b\n    this.particleGeometry.attributes.customOpacity.array[i] = this.particleArray[i].opacity\n    this.particleGeometry.attributes.customSize.array[i] = this.particleArray[i].size\n    this.particleGeometry.attributes.customAngle.array[i] = this.particleArray[i].angle\n  }\n\n  this.particleGeometry.attributes.position.needsUpdate = true\n  this.particleGeometry.attributes.customVisible.needsUpdate = true\n  this.particleGeometry.attributes.customColor.needsUpdate = true\n  this.particleGeometry.attributes.customOpacity.needsUpdate = true\n  this.particleGeometry.attributes.customSize.needsUpdate = true\n  this.particleGeometry.attributes.customAngle.needsUpdate = true\n\n  // stop emitter?\n  this.emitterAge += dt\n  if (this.emitterAge > this.emitterDeathAge) this.emitterAlive = false\n}\n\nParticleEngine.prototype.destroy = function () {\n  // scene.remove(this.particleMesh)\n}\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\nexport { ParticleEngine, Tween, Particle, Type }\n\n\n\n// WEBPACK FOOTER //\n// ./src/ParticleEngine/ParticleEngine.js","// import * as THREE from 'three'\nimport phong from './shaders/phong.js'\nimport {\n  ParticleEngine\n} from './ParticleEngine/ParticleEngine.js'\nimport {\n  Examples\n} from './ParticleEngine/ParticleEngineExamples.js'\nimport {\n  debug,\n  inspect\n} from 'util';\n\nvar container, stats\nvar camera, scene, renderer\nvar controls, ambientLight, directionalLight, spotLight\nvar pointLight, planeuniform, verticalMirror, spotLight2\nvar miku, stage\nwindow.particleEngine = null\nvar spotlightHelper2, spotLightHelper, pointLightHelper\n\n// shadowMap variable\nvar SHADOW_MAP_WIDTH = 1024\nvar SHADOW_MAP_HEIGHT = 1024\n\n// screen variable\nvar SCREEN_WIDTH = window.innerWidth\nvar SCREEN_HEIGHT = window.innerHeight\nvar NEAR = 1\nvar FAR = 10000\n\ninit()\nanimate()\n\nfunction init() {\n  // scene\n  scene = new THREE.Scene()\n  scene.background = new THREE.Color(0x00cc00)\n\n  // canvas\n  container = document.createElement('div')\n  document.body.appendChild(container)\n  camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, NEAR, FAR)\n  camera.position.z = 250\n  scene.add(camera)\n\n  renderer = new THREE.WebGLRenderer()\n  renderer.setPixelRatio(window.devicePixelRatio)\n  renderer.setSize(window.innerWidth, window.innerHeight)\n  renderer.shadowMap.enabled = true\n  renderer.shadowMap.needsUpdate = true\n  renderer.shadowMap.type = THREE.PCFShadowMap // PCF shadowMap now\n  container.appendChild(renderer.domElement)\n\n  // control\n  controls = new THREE.OrbitControls(camera, renderer.domElement)\n  controls.addEventListener('change', render)\n  controls.minDistance = 10\n  controls.maxDistance = 800\n  controls.enablePan = true\n\n  // lights\n  ambientLight = new THREE.AmbientLight(0xcccccc, 0.4)\n  scene.add(ambientLight)\n\n  // directional light\n  directionalLight = new THREE.DirectionalLight(0x0000cc, 0.4)\n  directionalLight.position.copy(new THREE.Vector3(0, 300, 300))\n  var target = new THREE.Object3D()\n  target.position.copy(new THREE.Vector3(0, 0, -5))\n\n  scene.add(directionalLight)\n  scene.add(target)\n  directionalLight.target = target\n\n  // point light\n  pointLight = new THREE.PointLight(0xff0000, 0.4, 500)\n  pointLight.position.set(-25, 0, -10)\n  pointLight.castShadow = true\n  scene.add(pointLight)\n  var sphereSize = 1;\n  pointLightHelper = new THREE.PointLightHelper(pointLight, sphereSize);\n  pointLightHelper.visible = false\n  scene.add(pointLightHelper);\n\n  // spotlight\n  spotLight = new THREE.SpotLight(0xffff00, 1)\n  window.t = spotLight\n  spotLight.position.set(5, 95, 100)\n  spotLight.angle = Math.PI / 8\n  spotLight.penumbra = 0.08\n  spotLight.decay = 2\n  spotLight.distance = 400\n  // spotLight.shadow.bias = 0.0001\n  spotLight.castShadow = true\n  spotLight.shadow.mapSize.width = SHADOW_MAP_WIDTH\n  spotLight.shadow.mapSize.height = SHADOW_MAP_HEIGHT\n  spotLight.shadow.camera.near = 10\n  spotLight.shadow.camera.far = 180\n  scene.add(spotLight)\n\n  // floor texture\n  let textureLoader = new THREE.TextureLoader()\n  textureLoader.load(\n    '../images/floor.jpg',\n    function (texture) {\n      var material = new THREE.MeshBasicMaterial({\n        map: texture,\n        blending: THREE.AdditiveBlending,\n        transparent: true,\n        opacity: 0.3\n      })\n      var geometry = new THREE.BoxGeometry(387, 0.0001, 266)\n      //  var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n      let cube = new THREE.Mesh(geometry, material)\n      cube.position.copy(new THREE.Vector3(-27, -94, 5))\n      cube.castShadow = false\n      cube.receiveShadow = true\n      scene.add(cube)\n    },\n    function (xhr) {\n      // console.log((xhr.loaded / xhr.total * 100) + '% loaded')\n    },\n    function (xhr) {\n      console.error('An error happened')\n    }\n  )\n\n  // Miku model\n  THREE.Loader.Handlers.add(/\\.dds$/i, new THREE.DDSLoader())\n  let mtlLoader = new THREE.MTLLoader()\n  mtlLoader.setPath('../models/Miku/')\n  mtlLoader.load('Miku.mtl', function (materials) {\n    materials.preload()\n    let objLoader = new THREE.OBJLoader()\n    objLoader.setMaterials(materials)\n    objLoader.setPath('../models/Miku/')\n    objLoader.load('Miku.obj', function (object) {\n      object.position.y = -95\n      object.position.x = -25\n      object.traverse(function (node) {\n        if (node instanceof THREE.Mesh) {\n          node.castShadow = true\n          node.receiveShadow = false\n        }\n      })\n      miku = object\n      scene.add(object)\n\n      // verticalMirror.target = object\n      spotLight.target = object\n      scene.add(spotLight.target)\n\n      controls.target.copy(object.position)\n      controls.update()\n\n      // stage model\n      let objLoader = new THREE.OBJLoader()\n      objLoader.setPath('../models/stage/')\n      objLoader.load('stage.obj', function (object) {\n        object.position.y -= 123.8\n        object.scale.x = 20\n        object.scale.y = 20\n        object.scale.z = 20\n        object.traverse(function (node) {\n          if (node instanceof THREE.Mesh) {\n            node.receiveShadow = true;\n            node.castShadow = true;\n          }\n        })\n        stage = object\n        scene.add(object)\n\n        initGUI()\n      }, (xhr) => {\n        // console.log(xhr)\n      }, (xhr) => {\n        console.log(xhr)\n      })\n    }, (xhr) => {\n      // console.log(xhr)\n    }, (xhr) => {\n      console.log(xhr)\n    })\n  })\n\n  spotLightHelper = new THREE.SpotLightHelper(spotLight)\n  spotLightHelper.visible = false\n  scene.add(spotLightHelper)\n\n  let huajiTexture = textureLoader.load(\"../images/huaji.png\")\n  let backboardTex = textureLoader.load(\"../images/backboard.jpg\")\n\n  window.shader = THREE.ShaderLib[\"phong\"]\n  window.uniforms = THREE.UniformsUtils.clone(shader.uniforms)\n  uniforms[\"map\"].value = huajiTexture\n  uniforms[\"showMapTexture\"] = {\n    'type': 'b',\n    'value': true\n  }\n  uniforms[\"time\"] = {\n    'type': 'f',\n    'value': 0.5\n  }\n  window.m = new THREE.ShaderMaterial({\n    fragmentShader: phong.frag,\n    vertexShader: phong.vert,\n    uniforms: uniforms,\n    lights: true\n  })\n  let box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -10, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -20, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -30, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -40, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -50, 0)\n  scene.add(box)\n\n  particleSystem('clouds')\n\n  // projective texture mapping\n  spotLight2 = new THREE.SpotLight(0xffff00, 0.3)\n  spotLight2.position.set(-70, 95, 100)\n  spotLight2.angle = Math.PI / 8\n  spotLight2.penumbra = 0.08\n  spotLight2.decay = 2\n  spotLight2.distance = 400\n  spotLight2.castShadow = true\n  spotLight2.shadow.mapSize.width = SHADOW_MAP_WIDTH\n  spotLight2.shadow.mapSize.height = SHADOW_MAP_HEIGHT\n  spotLight2.shadow.camera.near = 10\n  spotLight2.shadow.camera.far = 180\n\n  planeuniform = THREE.UniformsUtils.clone(shader.uniforms)\n  planeuniform[\"diffuse\"] = {\n    type: 'c',\n    value: new THREE.Color(0xffffff)\n  }\n  planeuniform[\"showMapTexture\"] = {\n    type: 'b',\n    value: true\n  }\n  planeuniform[\"blendingParam\"] = {\n    type: 'f',\n    value: 0.5\n  }\n  planeuniform[\"map\"] = {\n    value: backboardTex\n  }\n  planeuniform[\"mapProj\"] = {\n    \"type\": \"t\",\n    \"value\": huajiTexture\n  };\n  planeuniform[\"textureMatrixProj\"] = {\n    \"type\": \"m4\",\n    \"value\": new THREE.Matrix4()\n  };\n  planeuniform[\"spotLightPosition\"] = {\n    value: spotLight2.position\n  }\n  planeuniform['spotLightColor'] = {\n    value: new THREE.Color(0xffffff)\n  }\n  let planegeo = new THREE.PlaneBufferGeometry(200, 200)\n  let planemtl = new THREE.ShaderMaterial({\n    fragmentShader: phong.frag,\n    vertexShader: phong.vert,\n    uniforms: planeuniform,\n    lights: true\n  })\n  let plane = new THREE.Mesh(planegeo, planemtl)\n  plane.position.set(-30, 0, -130)\n  scene.add(plane)\n\n  let targetObject = new THREE.Object3D()\n  targetObject.position.set(-50, 0, -130)\n  spotLight2.target = targetObject\n  targetObject.updateMatrixWorld()\n  scene.add(spotLight2)\n  scene.add(targetObject)\n\n  spotlightHelper2 = new THREE.SpotLightHelper(spotLight2)\n  spotlightHelper2.visible = false\n  scene.add(spotlightHelper2)\n  plane.material.uniforms.textureMatrixProj.value = makeProjectiveMatrixForLight(spotLight2)\n\n  window.addEventListener('resize', onWindowResize, false)\n\n  //mirror reflector\n  verticalMirror = new THREE.Reflector(400, 350, {\n    clipBias: 0.002,\n    textureWidth: SCREEN_WIDTH * window.devicePixelRatio,\n    textureHeight: SCREEN_HEIGHT * window.devicePixelRatio,\n    color: 0x889999,\n    recursion: 1\n  })\n  verticalMirror.position.y = 50\n  verticalMirror.position.x = -260\n  verticalMirror.position.z = -70\n  verticalMirror.rotateY(Math.PI / 2)\n  verticalMirror.visible = false\n  // verticalMirror.lookAtPosition.add(-camera.matrixWorld.position)\n  scene.add(verticalMirror)\n}\n\nfunction onWindowResize() {\n  camera.aspect = window.innerWidth / window.innerHeight\n  camera.updateProjectionMatrix()\n  renderer.setSize(window.innerWidth, window.innerHeight)\n}\n\nvar lastTime = null\n\nfunction animate(time) {\n  if (!lastTime) {\n    lastTime = time\n  }\n  uniforms.time.value = time / 300\n  requestAnimationFrame(animate)\n  if (particleEngine) {\n    let delta = time - lastTime\n    particleEngine.update(delta / 1000)\n  }\n  lastTime = time\n  render()\n}\n\nfunction render() {\n  renderer.render(scene, camera)\n}\n\nfunction makeProjectiveMatrixForLight(l) {\n  var lightCamera = new THREE.PerspectiveCamera(l.angle * 180 / Math.PI, 1.0, 1, 1000)\n  var lightMatrix = new THREE.Matrix4()\n  var targetPosition = new THREE.Vector3()\n\n  lightCamera.position.setFromMatrixPosition(l.matrixWorld)\n  targetPosition.setFromMatrixPosition(l.target.matrixWorld)\n  lightCamera.lookAt(targetPosition)\n  lightCamera.updateMatrixWorld()\n\n  lightCamera.matrixWorldInverse.getInverse(lightCamera.matrixWorld)\n\n  lightMatrix.set(\n    0.5, 0.0, 0.0, 0.5,\n    0.0, 0.5, 0.0, 0.5,\n    0.0, 0.0, 0.5, 0.5,\n    0.0, 0.0, 0.0, 1.0\n  )\n\n  lightMatrix.multiply(lightCamera.projectionMatrix)\n  lightMatrix.multiply(lightCamera.matrixWorldInverse)\n\n  return lightMatrix\n}\n\nfunction initGUI() {\n  // var API = {\n  //   'show directional light': true,\n  //   'show spot light': true,\n  //   'show ambient light': true\n  // }\n  // var gui = new dat.GUI()\n  // gui.add(API, 'show directional light').onChange(function () {\n  //   directionalLight.visible = API['show directional light']\n  // })\n  let gui = new dat.GUI({\n    width: '300px'\n  })\n\n  let folder = gui.addFolder(\"Miku\")\n  let shadingConf = {\n    'Shading': 'Smooth Shading'\n  }\n  folder.add(shadingConf, 'Shading', ['Smooth Shading', 'Flat Shading'])\n    .onChange((value) => {\n      miku.traverse((node) => {\n        if (node instanceof THREE.Mesh) {\n          if (value == 'Flat Shading') {\n            if (node.material instanceof THREE.MeshPhongMaterial) {\n              node.material.flatShading = true\n              node.material.needsUpdate = true\n            } else {\n              for (let k in node.material) {\n                node.material[k].flatShading = true\n                node.material[k].needsUpdate = true\n              }\n            }\n          } else {\n            if (node.material instanceof THREE.MeshPhongMaterial) {\n              node.material.flatShading = false\n              node.material.needsUpdate = true\n            } else {\n              for (let k in node.material) {\n                node.material[k].flatShading = false\n                node.material[k].needsUpdate = true\n              }\n            }\n          }\n        }\n      })\n    })\n\n  folder = gui.addFolder(\"Directional Light\")\n  let directionalLightConf = {\n    visible: directionalLight.visible,\n    color: directionalLight.color.getStyle()\n  }\n  folder.add(directionalLightConf, 'visible').onChange(() => {\n    directionalLight.visible = directionalLightConf['visible']\n  })\n  folder.addColor(directionalLightConf, 'color').onChange((value) => {\n    directionalLight.color.setStyle(value)\n  })\n  // folder.open()\n\n  folder = gui.addFolder(\"Point Light\")\n  let pointLightConf = {\n    visible: pointLight.visible,\n    color: pointLight.color.getStyle(),\n    castShadow: pointLight.castShadow\n  }\n  folder.add(pointLightConf, 'visible').onChange(() => {\n    pointLight.visible = pointLightConf['visible']\n  })\n  folder.addColor(pointLightConf, 'color').onChange((value) => {\n    pointLight.color.setStyle(value)\n  })\n  folder.add(pointLightConf, 'castShadow').onChange(() => {\n    pointLight.castShadow = pointLightConf['castShadow']\n  })\n  // folder.open()\n\n  folder = gui.addFolder(\"Spot Light\")\n  let spotLightConf = {\n    visible: spotLight.visible,\n    color: spotLight.color.getStyle(),\n    castShadow: spotLight.castShadow\n  }\n  folder.add(spotLightConf, 'visible').onChange(() => {\n    spotLight.visible = spotLightConf['visible']\n  })\n  folder.addColor(spotLightConf, 'color').onChange((value) => {\n    spotLight.color.setStyle(value)\n  })\n  folder.add(spotLightConf, 'castShadow').onChange(() => {\n    spotLight.castShadow = spotLightConf['castShadow']\n  })\n\n  /*\n  Type: Value\n  BasicShadowMap: 0\n  PCFShadowMap: 1\n  PCFSoftShadowMap: 2\n  */\n  folder = gui.addFolder(\"ShadowMap\")\n  let ShadowMapConf = {\n    ShadowMapType: renderer.shadowMap.type,\n  }\n  folder.add(ShadowMapConf, 'ShadowMapType').min(0).max(2).step(1).onChange((value) => {\n    renderer.shadowMap.type = value\n    renderer.clearTarget(spotLight.shadow.map)\n    miku.traverse((node) => {\n      if (node instanceof THREE.Mesh)\n      {\n        if (node.material instanceof THREE.MeshPhongMaterial) {\n          node.material.needsUpdate = true\n        } else {\n          for (let k in node.material) {\n            node.material[k].needsUpdate = true\n          }\n        }\n      } else {\n        if (node.material instanceof THREE.MeshPhongMaterial) {\n          node.material.needsUpdate = true\n        } else {\n          for (let k in node.material) {\n            node.material[k].needsUpdate = true\n          }\n        }\n      }\n    })\n    stage.traverse((node) => {\n      if (node instanceof THREE.Mesh) {\n        if (node.material instanceof THREE.MeshPhongMaterial) {\n          node.material.needsUpdate = true\n        } else {\n          for (let k in node.material) {\n            node.material[k].needsUpdate = true\n          }\n        }\n      } else {\n        if (node.material instanceof THREE.MeshPhongMaterial) {\n          node.material.needsUpdate = true\n        } else {\n          for (let k in node.material) {\n            node.material[k].needsUpdate = true\n          }\n        }\n      }\n    })\n  })\n\n  folder = gui.addFolder(\"Projective Texture\")\n  let ProjectiveTextureConf = {\n    blendingParam: planeuniform[\"blendingParam\"].value,\n    showMapTexture: planeuniform[\"showMapTexture\"].value\n  }\n  folder.add(ProjectiveTextureConf, 'blendingParam').min(0.0).max(1.0).step(0.1).onChange((value) => {\n    planeuniform[\"blendingParam\"].value = value\n  })\n  folder.add(ProjectiveTextureConf, 'showMapTexture').onChange((value) => {\n    planeuniform[\"showMapTexture\"].value = value\n  })\n\n  folder = gui.addFolder(\"Mirror\")\n  let MirrorConf = {\n    mirror: verticalMirror.visible\n  }\n  folder.add(MirrorConf, 'mirror').onChange((value) => {\n    verticalMirror.visible = value\n    pointLight.visible = (!value)\n    spotLight.visible = (!value)\n    directionalLight.visible = (!value)\n  })\n\n  folder = gui.addFolder(\"Helper\")\n  let HelperConf = {\n    spotLightHelper1: spotLightHelper.visible,\n    spotLightHelper2: spotlightHelper2.visible,\n    pointLightHelper: pointLightHelper.visible\n  }\n  folder.add(HelperConf, 'spotLightHelper1').onChange((value) => {\n    spotLightHelper.visible = value\n  })\n  folder.add(HelperConf, 'spotLightHelper2').onChange((value) => {\n    spotlightHelper2.visible = value\n  })\n  folder.add(HelperConf, 'pointLightHelper').onChange((value) => {\n    pointLightHelper.visible = value\n  })\n  // folder.open()\n}\n\nfunction particleSystem(effectName) {\n  let example = new Examples()\n  let paras = example.getEffect(effectName)\n\n  if (!paras) {\n    console.error('[particle system] no parameters')\n  }\n\n  let path = paras.particleTexturePath\n  let loader = new THREE.TextureLoader()\n  loader.load('../images/smokeparticle.png',\n    (_texture) => {\n      paras.particleTexture = _texture\n      let group = new THREE.Group()\n      particleEngine = new ParticleEngine()\n      particleEngine.setValues(paras)\n      particleEngine.initialize()\n\n      group.add(particleEngine.particleMesh)\n      scene.add(group)\n    },\n    (xhr) => {\n      console.log(xhr.loaded / xhr.total + '% loaded ' + path)\n    },\n    (xhr) => {\n      console.warn('[ParticleEffectsMarker] an error happened while loading ' + path)\n    })\n}\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","var phong = {}\n\nphong.frag = `\n#define PHONG\n#define USE_MAP\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool showMapTexture;\nuniform float time;\nuniform sampler2D mapProj;\nvarying vec4 texCoordProj;\nvarying vec3 vNormalProj;\nvarying vec3 vViewPositionProj;\nuniform vec3 spotLightPosition;\nuniform vec3 spotLightColor;\nuniform float blendingParam;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n  #ifdef USE_MAP\n    if (showMapTexture) {\n\t\t\tvec2 transformedvUv = vec2(vUv);\n\t\t\ttransformedvUv.x = mod(transformedvUv.x + time, 1.0);\n      vec4 texelColor = texture2D( map, transformedvUv );\n      texelColor = mapTexelToLinear( texelColor );\n      diffuseColor *= texelColor;\n    }\n  #endif\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#ifdef USE_MAP\n\t\tif (showMapTexture) {\n\t\t\toutgoingLight = outgoingLight * blendingParam + diffuseColor.xyz * (1.0 - blendingParam);\n\t\t}\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\tvec4 texColorProj = texCoordProj.q < 0.0 ? vec4(0.0, 0.0, 0.0, 0.0) : texture2DProj( mapProj, texCoordProj); // for projective texturing\n\n\tgl_FragColor.xyz += texColorProj.xyz;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n`\n\nphong.vert = `\n#define PHONG\n#define USE_MAP\nvarying vec3 vViewPosition;\nuniform mat4 textureMatrixProj;\nvarying vec4 texCoordProj;\nvarying vec3 vNormalProj;\nvarying vec3 vViewPositionProj;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\t#endif\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\ttexCoordProj = textureMatrixProj * modelMatrix * vec4(position, 1.0);\n\tvNormalProj = normalMatrix * normal;\n\tvNormalProj = normalize(vNormalProj);\n\tvViewPositionProj = -(modelMatrix * vec4(position, 1.0)).xyz;\n}\n`\n\nexport default phong\n\n\n// WEBPACK FOOTER //\n// ./src/shaders/phong.js","import { Tween, Type } from './ParticleEngine.js'\n/**\n* @author Lee Stemkoski   http://www.adelphi.edu/~stemkoski/\n*/\n\n/*\n  Particle Engine options:\n\n  positionBase   : new THREE.THREE.Vector3(),\n  positionStyle : Type.CUBE or Type.SPHERE,\n\n  // for Type.CUBE\n  positionSpread  : new THREE.THREE.Vector3(),\n\n  // for Type.SPHERE\n  positionRadius  : 10,\n\n  velocityStyle : Type.CUBE or Type.SPHERE,\n\n  // for Type.CUBE\n  velocityBase       : new THREE.THREE.Vector3(),\n  velocitySpread     : new THREE.THREE.Vector3(),\n\n  // for Type.SPHERE\n  speedBase   : 20,\n  speedSpread : 10,\n\n  accelerationBase   : new THREE.THREE.Vector3(),\n  accelerationSpread : new THREE.THREE.Vector3(),\n\n  particleTexture : THREE.ImageUtils.loadTexture( 'images/star.png' ),\n\n  // rotation of image used for particles\n  angleBase               : 0,\n  angleSpread             : 0,\n  angleVelocityBase       : 0,\n  angleVelocitySpread     : 0,\n  angleAccelerationBase   : 0,\n  angleAccelerationSpread : 0,\n\n  // size, color, opacity\n  //   for static  values, use base/spread\n  //   for dynamic values, use Tween\n  //   (non-empty Tween takes precedence)\n  sizeBase   : 20.0,\n  sizeSpread : 5.0,\n  sizeTween  : new Tween( [0, 1], [1, 20] ),\n\n  // colors stored in THREE.Vector3 in H,S,L format\n  colorBase   : new THREE.THREE.Vector3(0.0, 1.0, 0.5),\n  colorSpread : new THREE.THREE.Vector3(0,0,0),\n  colorTween  : new Tween( [0.5, 2], [ new THREE.THREE.Vector3(0, 1, 0.5), new THREE.THREE.Vector3(1, 1, 0.5) ] ),\n\n  opacityBase   : 1,\n  opacitySpread : 0,\n  opacityTween  : new Tween( [2, 3], [1, 0] ),\n\n  blendStyle    : THREE.NormalBlending (default), THREE.AdditiveBlending\n\n  particlesPerSecond : 200,\n  particleDeathAge   : 2.0,\n  emitterDeathAge    : 60\n*/\n\n/*\nvar initExamples = {\n  // Not just any fountain -- a RAINBOW STAR FOUNTAIN of AWESOMENESS\n  fountain:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new THREE.Vector3(0, 5, 0),\n    positionSpread: new THREE.Vector3(10, 0, 10),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new THREE.Vector3(0, 160, 0),\n    velocitySpread: new THREE.Vector3(100, 20, 100),\n\n    accelerationBase: new THREE.Vector3(0, -100, 0),\n\n    particleTexture: null,\n    particleTexturePath: '../images/star.png',\n\n    angleBase: 0,\n    angleSpread: 180,\n    angleVelocityBase: 0,\n    angleVelocitySpread: 360 * 4,\n\n    sizeTween: new Tween([0, 1], [1, 20]),\n    opacityTween: new Tween([2, 3], [1, 0]),\n    colorTween: new Tween([0.5, 2], [new THREE.Vector3(0, 1, 0.5), new THREE.Vector3(0.8, 1, 0.5)]),\n\n    particlesPerSecond: 200,\n    particleDeathAge: 3.0,\n    emitterDeathAge: 60\n  },\n\n  fireball:\n  {\n    positionStyle: Type.SPHERE,\n    positionBase: new THREE.Vector3(0, 50, 0),\n    positionRadius: 2,\n\n    velocityStyle: Type.SPHERE,\n    speedBase: 40,\n    speedSpread: 8,\n\n    particleTexture: null,\n    particleTexturePath: '../images/smokeparticle.png',\n\n    sizeTween: new Tween([0, 0.1], [1, 150]),\n    opacityTween: new Tween([0.7, 1], [1, 0]),\n    colorBase: new Vector3(0.02, 1, 0.4),\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 60,\n    particleDeathAge: 1.5,\n    emitterDeathAge: 60\n  },\n\n  starfield:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 200, 0),\n    positionSpread: new Vector3(600, 400, 600),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 0, 0),\n    velocitySpread: new Vector3(0.5, 0.5, 0.5),\n\n    angleBase: 0,\n    angleSpread: 720,\n    angleVelocityBase: 0,\n    angleVelocitySpread: 4,\n\n    particleTexture: null,\n    particleTexturePath: '../images/spikey.png',\n\n    sizeBase: 10.0,\n    sizeSpread: 2.0,\n    colorBase: new Vector3(0.15, 1.0, 0.9), // H,S,L\n    colorSpread: new Vector3(0.00, 0.0, 0.2),\n    opacityBase: 1,\n\n    particlesPerSecond: 20000,\n    particleDeathAge: 60.0,\n    emitterDeathAge: 0.1\n  },\n\n  fireflies:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 100, 0),\n    positionSpread: new Vector3(400, 200, 400),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 0, 0),\n    velocitySpread: new Vector3(60, 20, 60),\n\n    particleTexture: null,\n    particleTexturePath: '../images/spark.png',\n\n    sizeBase: 30.0,\n    sizeSpread: 2.0,\n    opacityTween: new Tween([0.0, 1.0, 1.1, 2.0, 2.1, 3.0, 3.1, 4.0, 4.1, 5.0, 5.1, 6.0, 6.1],\n      [0.2, 0.2, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 0.2]),\n    colorBase: new Vector3(0.30, 1.0, 0.6), // H,S,L\n    colorSpread: new Vector3(0.3, 0.0, 0.0),\n\n    particlesPerSecond: 20,\n    particleDeathAge: 6.1,\n    emitterDeathAge: 600\n  },\n\n  startunnel:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 0, 0),\n    positionSpread: new Vector3(10, 10, 10),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 100, 200),\n    velocitySpread: new Vector3(40, 40, 80),\n\n    angleBase: 0,\n    angleSpread: 720,\n    angleVelocityBase: 10,\n    angleVelocitySpread: 0,\n\n    particleTexture: null,\n    particleTexturePath: '../images/spikey.png',\n\n    sizeBase: 4.0,\n    sizeSpread: 2.0,\n    colorBase: new Vector3(0.15, 1.0, 0.8), // H,S,L\n    opacityBase: 1,\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 500,\n    particleDeathAge: 4.0,\n    emitterDeathAge: 60\n  },\n\n  firework:\n  {\n    positionStyle: Type.SPHERE,\n    positionBase: new Vector3(0, 100, 0),\n    positionRadius: 10,\n\n    velocityStyle: Type.SPHERE,\n    speedBase: 90,\n    speedSpread: 10,\n\n    accelerationBase: new Vector3(0, -80, 0),\n\n    particleTexture: null,\n    particleTexturePath: '../images/spark.png',\n\n    sizeTween: new Tween([0.5, 0.7, 1.3], [5, 40, 1]),\n    opacityTween: new Tween([0.2, 0.7, 2.5], [0.75, 1, 0]),\n    colorTween: new Tween([0.4, 0.8, 1.0], [new Vector3(0, 1, 1), new Vector3(0, 1, 0.6), new Vector3(0.8, 1, 0.6)]),\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 3000,\n    particleDeathAge: 2.5,\n    emitterDeathAge: 0.2\n  }\n} */\n\nvar examples =\n  {\n    // parameters above remain the same, to be modified\n    // effects below are modified for examples in earth. exmaples/qh-8-add-particles/debug.html\n    smoke:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(2, 2, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, 10),\n      velocitySpread: new THREE.Vector3(5, 5, 5),\n      accelerationBase: new THREE.Vector3(0, 0, -1),\n\n      particleTexture: null,\n      particleTexturePath: '../images/smokeparticle.png',\n\n      angleBase: 0,\n      angleSpread: 720,\n      angleVelocityBase: 0,\n      angleVelocitySpread: 720,\n\n      sizeTween: new Tween([0, 1], [32, 128]),\n      opacityTween: new Tween([0.8, 2], [0.5, 0]),\n      colorTween: new Tween([0.4, 1], [new THREE.Vector3(0, 0, 0.2), new THREE.Vector3(0, 0, 0.5)]),\n\n      particlesPerSecond: 400,\n      particleDeathAge: 2.0,\n      emitterDeathAge: 60\n    },\n\n    clouds:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(200, 200, 10),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0.4, 0, 0),\n      velocitySpread: new THREE.Vector3(0.2, 0, 0),\n\n      particleTexture: null,\n      particleTexturePath: '../../images/smokeparticle.png',\n\n      sizeBase: 40.0,\n      sizeSpread: 40.0,\n      colorBase: new THREE.Vector3(0.0, 0.0, 1.0), // H,S,L\n      opacityTween: new Tween([0, 1, 4, 5], [0, 1, 1, 0]),\n\n      particlesPerSecond: 20,\n      particleDeathAge: 4.0,\n      emitterDeathAge: 60\n    },\n\n    snow:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(5, 5, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, -1),\n      velocitySpread: new THREE.Vector3(1, 1, 0.5),\n      accelerationBase: new THREE.Vector3(0, 0, -0.5),\n\n      angleBase: 0,\n      angleSpread: 720,\n      angleVelocityBase: 0,\n      angleVelocitySpread: 60,\n\n      particleTexture: null,\n      particleTexturePath: '../images/snowflake.png',\n\n      sizeTween: new Tween([0, 0.25], [40, 80]),\n      colorBase: new THREE.Vector3(0.66, 1.0, 0.9), // H,S,L\n      opacityTween: new Tween([2, 3], [0.8, 0]),\n\n      particlesPerSecond: 20,\n      particleDeathAge: 4.0,\n      emitterDeathAge: 60\n    },\n\n    rain:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(5, 5, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, -3),\n      velocitySpread: new THREE.Vector3(1, 1, 2),\n      accelerationBase: new THREE.Vector3(0, 0, -2),\n\n      particleTexture: null,\n      particleTexturePath: '../images/raindrop2flip.png',\n\n      sizeBase: 60.0,\n      sizeSpread: 30.0,\n      colorBase: new THREE.Vector3(0.67, 1.0, 0.4), // H,S,L\n      colorSpread: new THREE.Vector3(0.00, 0.0, 0.2),\n      opacityBase: 0.6,\n\n      particlesPerSecond: 40,\n      particleDeathAge: 1.5,\n      emitterDeathAge: 60\n    },\n\n    candle:\n    {\n      positionStyle: Type.SPHERE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionRadius: 1,\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, 7),\n      velocitySpread: new THREE.Vector3(2, 2, 0),\n\n      particleTexture: null,\n      particleTexturePath: '../images/smokeparticle.png',\n\n      sizeTween: new Tween([0, 0.3, 1.2], [20, 150, 1]),\n      opacityTween: new Tween([0.9, 1.5], [1, 0]),\n      colorTween: new Tween([0.5, 1.0], [new THREE.Vector3(0.02, 1, 0.5), new THREE.Vector3(0.05, 1, 0)]),\n      blendStyle: THREE.AdditiveBlending,\n\n      particlesPerSecond: 600,\n      particleDeathAge: 12,\n      emitterDeathAge: 60\n    }\n\n  }\n\nfunction cloneExamples (examples) {\n  let dst = {}\n  for (let key in examples) {\n    dst[key] = {}\n    for (let u in examples[key]) {\n      if (examples[key][u] instanceof THREE.Vector3) {\n        dst[key][u] = examples[key][u].clone()\n      } else if (examples[key][u] instanceof Tween) {\n        dst[key][u] = examples[key][u].clone()\n      } else if (examples[key][u] instanceof Array) {\n        dst[key][u] = examples[key][u].slice()\n      } else if (examples[key][u] instanceof String) {\n        dst[key][u] = examples[key][u]\n      } else if (examples[key][u] instanceof Number) {\n        dst[key][u] = examples[key][u]\n      } else {\n        dst[key][u] = examples[key][u]\n      }\n    }\n  }\n  return dst\n}\n\nclass Examples {\n  constructor () {\n    this.examples = cloneExamples(examples)\n  }\n\n  exist (effect) {\n    if (this.examples[effect]) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  getEffect (effect) {\n    return this.examples[effect]\n  }\n\n  destruct () {\n    for (let key in this.examples) {\n      if (this.examples[key].particleTexture) {\n        this.examples[key].particleTexture.dispose()\n        this.examples[key].particleTexture = null\n      }\n    }\n  }\n}\n\nexport { Examples }\n\n\n\n// WEBPACK FOOTER //\n// ./src/ParticleEngine/ParticleEngineExamples.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/util.js\n// module id = 4\n// module chunks = 0","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 5\n// module chunks = 0","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/process/browser.js\n// module id = 6\n// module chunks = 0","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/support/isBufferBrowser.js\n// module id = 7\n// module chunks = 0","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/node_modules/inherits/inherits_browser.js\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}
=======
{"version":3,"sources":["webpack:///webpack/bootstrap 06ddbe8b11d33582bf44","webpack:///./src/ParticleEngine/ParticleEngine.js","webpack:///./src/index.js","webpack:///./src/shaders/phong.js","webpack:///./src/ParticleEngine/ParticleEngineExamples.js","webpack:///./node_modules/util/util.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/util/support/isBufferBrowser.js","webpack:///./node_modules/util/node_modules/inherits/inherits_browser.js","webpack:///./src/shaders/depth.js"],"names":["particleVertexShader","particleFragmentShader","Tween","timeArray","valueArray","times","values","prototype","constructor","lerp","t","i","n","length","p","THREE","Vector3","clone","ntimes","slice","nvalues","Particle","position","velocity","acceleration","angle","angleVelocity","angleAcceleration","size","color","Color","opacity","age","alive","update","dt","add","multiplyScalar","sizeTween","colorTween","colorHSL","setHSL","x","y","z","opacityTween","Type","Object","freeze","ParticleEngine","positionStyle","CUBE","positionBase","positionSpread","positionRadius","velocityStyle","velocityBase","velocitySpread","speedBase","speedSpread","accelerationBase","accelerationSpread","angleBase","angleSpread","angleVelocityBase","angleVelocitySpread","angleAccelerationBase","angleAccelerationSpread","sizeBase","sizeSpread","colorBase","colorSpread","opacityBase","opacitySpread","blendStyle","NormalBlending","particleArray","particlesPerSecond","particleDeathAge","emitterAge","emitterAlive","emitterDeathAge","particleCount","Math","min","particleGeometry","BufferGeometry","particleTexture","particleMaterial","ShaderMaterial","uniforms","texture","type","value","vertexShader","fragmentShader","transparent","alphaTest","blending","depthTest","particleMesh","Mesh","lastIndex","setValues","parameters","undefined","key","Points","randomValue","base","spread","random","randomVector3","rand3","addVectors","multiplyVectors","createParticle","particle","SPHERE","r","sqrt","vec3","cos","sin","direction","subVectors","speed","normalize","initialize","geovertices","geocustomvisible","geocustomcolor","geocustomopacity","geocustomsize","geocustomangle","concat","push","g","b","addAttribute","BufferAttribute","Float32Array","depthWrite","dynamic","sortParticles","floor","endIndex","recycleIndices","attributes","array","customVisible","customColor","customOpacity","customSize","customAngle","needsUpdate","j","destroy","container","stats","camera","scene","renderer","controls","ambientLight","directionalLight","spotLight","pointLight","planeuniform","miku","stage","depthTarget","postCamera","postScene","renderDepthFlag","depthuniform","window","particleEngine","SHADOW_MAP_WIDTH","SHADOW_MAP_HEIGHT","SCREEN_WIDTH","innerWidth","SCREEN_HEIGHT","innerHeight","NEAR","FAR","init","animate","Scene","background","document","createElement","body","appendChild","PerspectiveCamera","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","shadowMap","enabled","PCFShadowMap","domElement","OrbitControls","addEventListener","render","minDistance","maxDistance","enablePan","AmbientLight","DirectionalLight","copy","target","Object3D","PointLight","set","castShadow","sphereSize","pointLightHelper","PointLightHelper","SpotLight","PI","penumbra","decay","distance","shadow","mapSize","width","height","near","far","textureLoader","TextureLoader","load","material","MeshBasicMaterial","map","AdditiveBlending","geometry","BoxGeometry","cube","receiveShadow","xhr","console","error","Loader","Handlers","DDSLoader","mtlLoader","MTLLoader","setPath","materials","preload","objLoader","OBJLoader","setMaterials","object","traverse","node","updateMatrixWorld","scale","initGUI","log","huajiTexture","backboardTex","shader","ShaderLib","UniformsUtils","m","phong","frag","vert","lights","box","BoxBufferGeometry","particleSystem","spotLight2","Matrix4","planegeo","PlaneBufferGeometry","planemtl","plane","targetObject","textureMatrixProj","makeProjectiveMatrixForLight","initDepth","onWindowResize","aspect","updateProjectionMatrix","lastTime","time","requestAnimationFrame","delta","l","lightCamera","lightMatrix","targetPosition","setFromMatrixPosition","matrixWorld","lookAt","matrixWorldInverse","getInverse","multiply","projectionMatrix","gui","dat","GUI","folder","addFolder","shadingConf","onChange","MeshPhongMaterial","flatShading","k","directionalLightConf","visible","getStyle","addColor","setStyle","pointLightConf","spotLightConf","projectiveConf","showMapTexture","blendingParam","v","max","step","depthConf","cameraNear","cameraFar","effectName","example","paras","getEffect","path","particleTexturePath","loader","_texture","group","Group","loaded","total","warn","WebGLRenderTarget","format","RGBFormat","minFilter","NearestFilter","magFilter","generateMipmaps","stencilBuffer","depthBuffer","depthTexture","DepthTexture","UnsignedShortType","OrthographicCamera","tDiffuse","tDepth","postMaterial","depthShader","postPlane","postQuad","examples","smoke","clouds","snow","rain","candle","cloneExamples","dst","u","Array","String","Number","Examples","exist","effect","destruct","dispose"],"mappings":"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C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,uBAAuB,SAAS;AAChC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,KAAK;;AAEjD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,mCAAmC,OAAO;AAC1C;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;ACzkBA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;ACpBA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;ACvLtC;AACA;AACA;AACA;AACA;AACA,C;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtBA,IAAIgR,cAAc,EAAlB;;AAEAA,YAAYxF,IAAZ,GAAoB;;;;;;CAApB;;AAQAwF,YAAYzF,IAAZ,GAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAApB;;AAoCA,yDAAeyF,WAAf,E","file":"index_bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/build\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 06ddbe8b11d33582bf44","/**\n* @author Lee Stemkoski   http://www.adelphi.edu/~stemkoski/\n*/\n\n/// /// /// /// /\n// SHADERS //\n/// /// /// /// /\n\n// attribute: data that may be different for each particle (such as size and color)\n//      can only be used in vertex shader\n// varying: used to communicate data from vertex shader to fragment shader\n// uniform: data that is the same for each particle (such as texture)\n\nvar particleVertexShader =\n`\nattribute vec3  customColor;\nattribute float customOpacity;\nattribute float customSize;\nattribute float customAngle;\nattribute float customVisible; // float used as boolean (0 = false, 1 = true)\nvarying vec4  vColor;\nvarying float vAngle;\n\nvoid main()\n{\n  if ( customVisible > 0.5 ) { // true\n    vColor = vec4( customColor, customOpacity ); // set color associated to vertex use later in fragment shader.\n  } else { // false\n    vColor = vec4(0.0, 0.0, 0.0, 0.0); // make particle invisible.\n  }\n  vAngle = customAngle;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n  gl_PointSize = customSize * ( ( 1.0 / 200000.0 ) / length(cameraPosition.xyz - mvPosition.xyz) ); // scale particles as objects in 3D space\n  gl_Position = projectionMatrix * mvPosition;\n}\n`\nvar particleFragmentShader =\n`\nuniform sampler2D texture;\nvarying vec4 vColor;\nvarying float vAngle;\nvoid main()\n{\n  gl_FragColor = vColor;\n\n  float c = cos(vAngle);\n  float s = sin(vAngle);\n  vec2 rotatedUV = vec2(\n    c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,\n    c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5\n  );  // rotate UV coordinates to rotate texture\n  vec4 rotatedTexture = texture2D( texture,  rotatedUV );\n  gl_FragColor = gl_FragColor * rotatedTexture;    // sets an otherwise white particle texture to desired color\n}\n`\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// //\n// TWEEN CLASS //\n/// /// /// /// /// //\n\nvar Tween = function (timeArray, valueArray) {\n  this.times = timeArray || []\n  this.values = valueArray || []\n}\n\nTween.prototype.constructor = Tween\n\nTween.prototype.lerp = function (t) {\n  var i = 0\n  var n = this.times.length\n  while (i < n && t > this.times[i]) {\n    i++\n  }\n  if (i === 0) return this.values[0]\n  if (i === n) return this.values[n - 1]\n  var p = (t - this.times[i - 1]) / (this.times[i] - this.times[i - 1])\n  if (this.values[0] instanceof THREE.Vector3) {\n    return this.values[i - 1].clone().lerp(this.values[i], p)\n  } else { // its a float\n    return this.values[i - 1] + p * (this.values[i] - this.values[i - 1])\n  }\n}\n\nTween.prototype.clone = function () {\n  let ntimes = this.times.slice()\n  let nvalues = this.values.slice()\n  return new this.constructor(ntimes, nvalues)\n}\n\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// /// //\n// PARTICLE CLASS //\n/// /// /// /// /// /// //\n\nvar Particle = function () {\n  this.position = new THREE.Vector3()\n  this.velocity = new THREE.Vector3() // units per second\n  this.acceleration = new THREE.Vector3()\n\n  this.angle = 0\n  this.angleVelocity = 0 // degrees per second\n  this.angleAcceleration = 0 // degrees per second, per second\n\n  this.size = 16.0\n\n  this.color = new THREE.Color()\n  this.opacity = 1.0\n\n  this.age = 0\n  this.alive = 0 // use float instead of boolean for shader purposes\n}\n\nParticle.prototype.constructor = Particle\n\nParticle.prototype.update = function (dt) {\n  this.position.add(this.velocity.clone().multiplyScalar(dt))\n  this.velocity.add(this.acceleration.clone().multiplyScalar(dt))\n\n  // convert from degrees to radians: 0.01745329251 = Math.PI/180\n  this.angle += this.angleVelocity * 0.01745329251 * dt\n  this.angleVelocity += this.angleAcceleration * 0.01745329251 * dt\n\n  this.age += dt\n\n  // if the tween for a given attribute is nonempty,\n  //  then use it to update the attribute's value\n\n  if (this.sizeTween.times.length > 0) {\n    this.size = this.sizeTween.lerp(this.age)\n  }\n\n  if (this.colorTween.times.length > 0) {\n    var colorHSL = this.colorTween.lerp(this.age)\n    this.color = new THREE.Color().setHSL(colorHSL.x, colorHSL.y, colorHSL.z)\n  }\n\n  if (this.opacityTween.times.length > 0) {\n    this.opacity = this.opacityTween.lerp(this.age)\n  }\n}\n\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\n/// /// /// /// /// /// /// /// ///\n// PARTICLE ENGINE CLASS //\n/// /// /// /// /// /// /// /// ///\n\nvar Type = Object.freeze({ 'CUBE': 1, 'SPHERE': 2 })\n\nvar ParticleEngine = function () {\n  /// /// /// /// /// /// /// /// /\n  // PARTICLE PROPERTIES //\n  /// /// /// /// /// /// /// /// /\n\n  this.positionStyle = Type.CUBE\n  this.positionBase = new THREE.Vector3()\n  // cube shape data\n  this.positionSpread = new THREE.Vector3()\n  // sphere shape data\n  this.positionRadius = 0 // distance from base at which particles start\n\n  this.velocityStyle = Type.CUBE\n  // cube movement data\n  this.velocityBase = new THREE.Vector3()\n  this.velocitySpread = new THREE.Vector3()\n  // sphere movement data\n  //   direction vector calculated using initial position\n  this.speedBase = 0\n  this.speedSpread = 0\n\n  this.accelerationBase = new THREE.Vector3()\n  this.accelerationSpread = new THREE.Vector3()\n\n  this.angleBase = 0\n  this.angleSpread = 0\n  this.angleVelocityBase = 0\n  this.angleVelocitySpread = 0\n  this.angleAccelerationBase = 0\n  this.angleAccelerationSpread = 0\n\n  this.sizeBase = 0.0\n  this.sizeSpread = 0.0\n  this.sizeTween = new Tween()\n\n  // store colors in HSL format in a THREE.THREE.Vector3 object\n  // http://en.wikipedia.org/wiki/HSL_and_HSV\n  this.colorBase = new THREE.Vector3(0.0, 1.0, 0.5)\n  this.colorSpread = new THREE.Vector3(0.0, 0.0, 0.0)\n  this.colorTween = new Tween()\n\n  this.opacityBase = 1.0\n  this.opacitySpread = 0.0\n  this.opacityTween = new Tween()\n\n  this.blendStyle = THREE.NormalBlending // false\n\n  this.particleArray = []\n  this.particlesPerSecond = 100\n  this.particleDeathAge = 1.0\n\n  /// /// /// /// /// /// /// ///\n  // EMITTER PROPERTIES //\n  /// /// /// /// /// /// /// ///\n\n  this.emitterAge = 0.0\n  this.emitterAlive = true\n  this.emitterDeathAge = 60 // time (seconds) at which to stop creating particles.\n\n  // How many particles could be active at any time?\n  this.particleCount = this.particlesPerSecond * Math.min(this.particleDeathAge, this.emitterDeathAge)\n\n  /// /// /// /// //\n  // THREE.JS //\n  /// /// /// /// //\n\n  this.particleGeometry = new THREE.BufferGeometry()\n  this.particleTexture = null\n  this.particleMaterial = new THREE.ShaderMaterial(\n    {\n      uniforms:\n      {\n        texture: { type: 't', value: this.particleTexture }\n      },\n      vertexShader: particleVertexShader,\n      fragmentShader: particleFragmentShader,\n      transparent: true,\n      alphaTest: 0.5,\n      // if having transparency issues, try including: alphaTest: 0.5\n      blending: THREE.NormalBlending,\n      depthTest: true\n    })\n  this.particleMesh = new THREE.Mesh()\n\n  this.lastIndex = -1\n}\n\nParticleEngine.prototype.constructor = ParticleEngine\n\nParticleEngine.prototype.setValues = function (parameters) {\n  if (parameters === undefined) return\n\n  // clear any previous tweens that might exist\n  this.sizeTween = new Tween()\n  this.colorTween = new Tween()\n  this.opacityTween = new Tween()\n\n  for (var key in parameters) {\n    this[key] = parameters[key]\n  }\n\n  // calculate/set derived particle engine values\n  this.particleArray = []\n  this.emitterAge = 0.0\n  this.emitterAlive = true\n  this.particleCount = this.particlesPerSecond * Math.min(this.particleDeathAge, this.emitterDeathAge)\n\n  this.particleGeometry = new THREE.BufferGeometry()\n  this.particleMaterial = new THREE.ShaderMaterial(\n    {\n      uniforms:\n      {\n        texture: { type: 't', value: parameters.particleTexture }\n      },\n      vertexShader: particleVertexShader,\n      fragmentShader: particleFragmentShader,\n      transparent: true,\n      alphaTest: 0.5,\n      // if having transparency issues, try including: alphaTest: 0.5,\n      blending: THREE.NormalBlending,\n      depthTest: true\n    })\n  this.particleMesh = new THREE.Points()\n}\n\n// helper functions for randomization\nParticleEngine.prototype.randomValue = function (base, spread) {\n  return base + spread * (Math.random() - 0.5)\n}\nParticleEngine.prototype.randomVector3 = function (base, spread) {\n  var rand3 = new THREE.Vector3(Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5)\n  return new THREE.Vector3().addVectors(base, new THREE.Vector3().multiplyVectors(spread, rand3))\n}\n\nParticleEngine.prototype.createParticle = function () {\n  var particle = new Particle()\n\n  particle.sizeTween = this.sizeTween\n  particle.colorTween = this.colorTween\n  particle.opacityTween = this.opacityTween\n\n  if (this.positionStyle === Type.CUBE) {\n    particle.position = this.randomVector3(this.positionBase, this.positionSpread)\n  }\n  if (this.positionStyle === Type.SPHERE) {\n    var z = 2 * Math.random() - 1\n    var t = 6.2832 * Math.random()\n    var r = Math.sqrt(1 - z * z)\n    var vec3 = new THREE.Vector3(r * Math.cos(t), r * Math.sin(t), z)\n    particle.position = new THREE.Vector3().addVectors(this.positionBase, vec3.multiplyScalar(this.positionRadius))\n  }\n\n  if (this.velocityStyle === Type.CUBE) {\n    particle.velocity = this.randomVector3(this.velocityBase, this.velocitySpread)\n  }\n  if (this.velocityStyle === Type.SPHERE) {\n    var direction = new THREE.Vector3().subVectors(particle.position, this.positionBase)\n    var speed = this.randomValue(this.speedBase, this.speedSpread)\n    particle.velocity = direction.normalize().multiplyScalar(speed)\n  }\n\n  particle.acceleration = this.randomVector3(this.accelerationBase, this.accelerationSpread)\n\n  particle.angle = this.randomValue(this.angleBase, this.angleSpread)\n  particle.angleVelocity = this.randomValue(this.angleVelocityBase, this.angleVelocitySpread)\n  particle.angleAcceleration = this.randomValue(this.angleAccelerationBase, this.angleAccelerationSpread)\n\n  particle.size = this.randomValue(this.sizeBase, this.sizeSpread)\n\n  var color = this.randomVector3(this.colorBase, this.colorSpread)\n  particle.color = new THREE.Color().setHSL(color.x, color.y, color.z)\n\n  particle.opacity = this.randomValue(this.opacityBase, this.opacitySpread)\n\n  particle.age = 0\n  particle.alive = 0 // particles initialize as inactive\n  // console.log('[ParticleEngine] createParticle', particle)\n  return particle\n}\n\nParticleEngine.prototype.initialize = function () {\n  // link particle data with geometry/material data\n  let geovertices = []\n  let geocustomvisible = []\n  let geocustomcolor = []\n  let geocustomopacity = []\n  let geocustomsize = []\n  let geocustomangle = []\n  for (var i = 0; i < this.particleCount; i++) {\n    // remove duplicate code somehow, here and in update function below.\n    this.particleArray[i] = this.createParticle()\n    geovertices = geovertices.concat([this.particleArray[i].position.x, this.particleArray[i].position.y, this.particleArray[i].position.z])\n    geocustomvisible.push(this.particleArray[i].alive)\n    geocustomcolor = geocustomcolor.concat([this.particleArray[i].color.r, this.particleArray[i].color.g, this.particleArray[i].color.b])\n    geocustomopacity.push(this.particleArray[i].opacity)\n    geocustomsize.push(this.particleArray[i].size)\n    geocustomangle.push(this.particleArray[i].angle)\n  }\n  this.particleGeometry.addAttribute('position', new  THREE.BufferAttribute(new Float32Array(geovertices), 3))\n  this.particleGeometry.addAttribute('customVisible', new THREE.BufferAttribute(new Float32Array(geocustomvisible), 1))\n  this.particleGeometry.addAttribute('customColor', new THREE.BufferAttribute(new Float32Array(geocustomcolor), 3))\n  this.particleGeometry.addAttribute('customOpacity', new THREE.BufferAttribute(new Float32Array(geocustomopacity), 1))\n  this.particleGeometry.addAttribute('customSize', new  THREE.BufferAttribute(new Float32Array(geocustomsize), 1))\n  this.particleGeometry.addAttribute('customAngle', new THREE.BufferAttribute(new Float32Array(geocustomangle), 1))\n\n  this.particleMaterial.blending = this.blendStyle\n  this.particleMaterial.depthWrite = false\n  // if (this.blendStyle !== NormalBlending) {\n  //   this.particleMaterial.depthWrite = false\n  // }\n\n  this.particleMesh = new THREE.Points(this.particleGeometry, this.particleMaterial)\n  this.particleMesh.dynamic = true\n  this.particleMesh.sortParticles = true\n  // scene.add(this.particleMesh)\n}\n\nParticleEngine.prototype.update = function (dt) {\n  // determine indices of particles to activate\n  if (this.lastIndex === -1) this.lastIndex = Math.floor(this.particlesPerSecond * (this.emitterAge + 0))\n  if (this.lastIndex < this.particleCount) {\n    var endIndex = Math.floor(this.particlesPerSecond * (this.emitterAge + dt))\n    if (endIndex > this.particleCount) endIndex = this.particleCount\n    for (let i = this.lastIndex; i < endIndex; ++i) {\n      this.particleArray[i].alive = 1.0\n    }\n    this.lastIndex = endIndex\n  }\n\n  var recycleIndices = []\n\n  // update particle data\n  for (var i = 0; i < this.particleCount; i++) {\n    if (this.particleArray[i].alive === 1.0) {\n      this.particleArray[i].update(dt)\n\n      // check if particle should expire\n      // could also use: death by size<0 or alpha<0.\n      if (this.particleArray[i].age > this.particleDeathAge) {\n        this.particleArray[i].alive = 0.0\n        recycleIndices.push(i)\n      }\n      // update particle properties in shader\n      this.particleGeometry.attributes.position.array[i * 3] = this.particleArray[i].position.x\n      this.particleGeometry.attributes.position.array[i * 3 + 1] = this.particleArray[i].position.y\n      this.particleGeometry.attributes.position.array[i * 3 + 2] = this.particleArray[i].position.z\n\n      this.particleGeometry.attributes.customVisible.array[i] = this.particleArray[i].alive\n      this.particleGeometry.attributes.customColor.array[i * 3] = this.particleArray[i].color.r\n      this.particleGeometry.attributes.customColor.array[i * 3 + 1] = this.particleArray[i].color.g\n      this.particleGeometry.attributes.customColor.array[i * 3 + 2] = this.particleArray[i].color.b\n      this.particleGeometry.attributes.customOpacity.array[i] = this.particleArray[i].opacity\n      this.particleGeometry.attributes.customSize.array[i] = this.particleArray[i].size\n      this.particleGeometry.attributes.customAngle.array[i] = this.particleArray[i].angle\n    }\n  }\n\n  this.particleGeometry.attributes.position.needsUpdate = true\n  this.particleGeometry.attributes.customVisible.needsUpdate = true\n  this.particleGeometry.attributes.customColor.needsUpdate = true\n  this.particleGeometry.attributes.customOpacity.needsUpdate = true\n  this.particleGeometry.attributes.customSize.needsUpdate = true\n  this.particleGeometry.attributes.customAngle.needsUpdate = true\n\n  // check if particle emitter is still running\n  if (!this.emitterAlive) return\n\n  // if any particles have died while the emitter is still running, we imediately recycle them\n  for (var j = 0; j < recycleIndices.length; j++) {\n    let i = recycleIndices[j]\n    this.particleArray[i] = this.createParticle()\n    this.particleArray[i].alive = 1.0 // activate right away\n    this.particleArray[i].update(dt)\n    this.particleGeometry.attributes.position.array[i * 3] = this.particleArray[i].position.x\n    this.particleGeometry.attributes.position.array[i * 3 + 1] = this.particleArray[i].position.y\n    this.particleGeometry.attributes.position.array[i * 3 + 2] = this.particleArray[i].position.z\n\n    this.particleGeometry.attributes.customVisible.array[i] = this.particleArray[i].alive\n    this.particleGeometry.attributes.customColor.array[i * 3] = this.particleArray[i].color.r\n    this.particleGeometry.attributes.customColor.array[i * 3 + 1] = this.particleArray[i].color.g\n    this.particleGeometry.attributes.customColor.array[i * 3 + 2] = this.particleArray[i].color.b\n    this.particleGeometry.attributes.customOpacity.array[i] = this.particleArray[i].opacity\n    this.particleGeometry.attributes.customSize.array[i] = this.particleArray[i].size\n    this.particleGeometry.attributes.customAngle.array[i] = this.particleArray[i].angle\n  }\n\n  this.particleGeometry.attributes.position.needsUpdate = true\n  this.particleGeometry.attributes.customVisible.needsUpdate = true\n  this.particleGeometry.attributes.customColor.needsUpdate = true\n  this.particleGeometry.attributes.customOpacity.needsUpdate = true\n  this.particleGeometry.attributes.customSize.needsUpdate = true\n  this.particleGeometry.attributes.customAngle.needsUpdate = true\n\n  // stop emitter?\n  this.emitterAge += dt\n  if (this.emitterAge > this.emitterDeathAge) this.emitterAlive = false\n}\n\nParticleEngine.prototype.destroy = function () {\n  // scene.remove(this.particleMesh)\n}\n/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /\n\nexport { ParticleEngine, Tween, Particle, Type }\n\n\n\n// WEBPACK FOOTER //\n// ./src/ParticleEngine/ParticleEngine.js","// import * as THREE from 'three'\nimport phong from './shaders/phong.js'\nimport depthShader from './shaders/depth.js'\nimport { ParticleEngine } from './ParticleEngine/ParticleEngine.js'\nimport { Examples } from './ParticleEngine/ParticleEngineExamples.js'\nimport { debug, inspect } from 'util';\n\nvar container, stats\nvar camera, scene, renderer\nvar controls, ambientLight, directionalLight, spotLight, pointLight, planeuniform\nvar miku, stage\nvar depthTarget, postCamera, postScene, renderDepthFlag = false, depthuniform\nwindow.particleEngine = null\n\n// shadowMap variable\nvar SHADOW_MAP_WIDTH = 1024\nvar SHADOW_MAP_HEIGHT = 1024\n\n// screen variable\nvar SCREEN_WIDTH = window.innerWidth\nvar SCREEN_HEIGHT = window.innerHeight\nvar NEAR = 1\nvar FAR = 1000\n\ninit()\nanimate()\n\nfunction init() {\n  // scene\n  scene = new THREE.Scene()\n  scene.background = new THREE.Color(0x00cc00)\n\n  // canvas\n  container = document.createElement('div')\n  document.body.appendChild(container)\n  camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, NEAR, FAR)\n  camera.position.z = 250\n  scene.add(camera)\n\n  renderer = new THREE.WebGLRenderer()\n  renderer.setPixelRatio(window.devicePixelRatio)\n  renderer.setSize(window.innerWidth, window.innerHeight)\n  renderer.shadowMap.enabled = true\n  renderer.shadowMap.type = THREE.PCFShadowMap // PCF shadowMap now\n  container.appendChild(renderer.domElement)\n\n  // control\n  controls = new THREE.OrbitControls(camera, renderer.domElement)\n  controls.addEventListener('change', render)\n  controls.minDistance = 10\n  controls.maxDistance = 800\n  controls.enablePan = true\n  controls.update()\n\n  // lights\n  ambientLight = new THREE.AmbientLight(0xcccccc, 0.4)\n  scene.add(ambientLight)\n\n  // directional light\n  directionalLight = new THREE.DirectionalLight(0x0000cc, 0.4)\n  directionalLight.position.copy(new THREE.Vector3(0, 300, 300))\n  var target = new THREE.Object3D()\n  target.position.copy(new THREE.Vector3(0, 0, -5))\n\n  scene.add(directionalLight)\n  scene.add(target)\n  directionalLight.target = target\n\n  // point light\n  pointLight = new THREE.PointLight(0xff0000, 0.4, 500)\n  pointLight.position.set(-25, 0, -10)\n  pointLight.castShadow = true\n  scene.add(pointLight)\n  var sphereSize = 1;\n  var pointLightHelper = new THREE.PointLightHelper(pointLight, sphereSize);\n  scene.add(pointLightHelper);\n\n  // spotlight\n  spotLight = new THREE.SpotLight(0xffff00, 1)\n  window.t = spotLight\n  spotLight.position.set(5, 95, 100)\n  spotLight.angle = Math.PI / 8\n  spotLight.penumbra = 0.08\n  spotLight.decay = 2\n  spotLight.distance = 400\n  // spotLight.shadow.bias = 0.0001\n  spotLight.castShadow = true\n  spotLight.shadow.mapSize.width = SHADOW_MAP_WIDTH\n  spotLight.shadow.mapSize.height = SHADOW_MAP_HEIGHT\n  spotLight.shadow.camera.near = 10\n  spotLight.shadow.camera.far = 180\n  scene.add(spotLight)\n\n  // floor texture\n  let textureLoader = new THREE.TextureLoader()\n  textureLoader.load(\n    '../images/floor.jpg',\n    function (texture) {\n      var material = new THREE.MeshBasicMaterial({\n        map: texture,\n        blending: THREE.AdditiveBlending,\n        transparent: true,\n        opacity: 0.3\n      })\n      var geometry = new THREE.BoxGeometry(387, 0.0001, 266)\n      //  var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} )\n      let cube = new THREE.Mesh(geometry, material)\n      cube.position.copy(new THREE.Vector3(-27, -94, 5))\n      cube.castShadow = false\n      cube.receiveShadow = true\n      scene.add(cube)\n    },\n    function (xhr) {\n      // console.log((xhr.loaded / xhr.total * 100) + '% loaded')\n    },\n    function (xhr) {\n      console.error('An error happened')\n    }\n  )\n\n  // Miku model\n  THREE.Loader.Handlers.add(/\\.dds$/i, new THREE.DDSLoader())\n  let mtlLoader = new THREE.MTLLoader()\n  mtlLoader.setPath('../models/Miku/')\n  mtlLoader.load('Miku.mtl', function (materials) {\n    materials.preload()\n    let objLoader = new THREE.OBJLoader()\n    objLoader.setMaterials(materials)\n    objLoader.setPath('../models/Miku/')\n    objLoader.load('Miku.obj', function (object) {\n      object.position.y = -95\n      object.position.x = -25\n      object.traverse(function (node) {\n        if (node instanceof THREE.Mesh) {\n          node.castShadow = true\n          node.receiveShadow = false\n        }\n      })\n      miku = object\n      scene.add(object)\n\n      // verticalMirror.target = object\n      spotLight.target = object\n      object.updateMatrixWorld()\n\n      controls.target.copy(object.position)\n      controls.update()\n\n      // stage model\n      let objLoader = new THREE.OBJLoader()\n      objLoader.setPath('../models/stage/')\n      objLoader.load('stage.obj', function (object) {\n        object.position.y -= 123.8\n        object.scale.x = 20\n        object.scale.y = 20\n        object.scale.z = 20\n        object.traverse(function (node) {\n          if (node instanceof THREE.Mesh) {\n            node.receiveShadow = true;\n            node.castShadow = true;\n          }\n        })\n        stage = object\n        scene.add(object)\n\n        initGUI()\n      }, (xhr) => {\n        // console.log(xhr)\n      }, (xhr) => {\n        console.log(xhr)\n      })\n    }, (xhr) => {\n      // console.log(xhr)\n    }, (xhr) => {\n      console.log(xhr)\n    })\n  })\n\n  // var spotLightHelper = new THREE.SpotLightHelper(projLight)\n  // scene.add(spotLightHelper)\n\n  let huajiTexture = textureLoader.load(\"../images/huaji.png\")\n  let backboardTex = textureLoader.load(\"../images/backboard.jpg\")\n\n  window.shader = THREE.ShaderLib[\"phong\"]\n  window.uniforms = THREE.UniformsUtils.clone(shader.uniforms)\n  uniforms[\"map\"].value = huajiTexture\n  uniforms[\"showMapTexture\"] = {\n    'type': 'b',\n    'value': true\n  }\n  uniforms[\"time\"] = {\n    'type': 'f',\n    'value': 0.5\n  }\n  window.m = new THREE.ShaderMaterial({\n    fragmentShader: phong.frag,\n    vertexShader: phong.vert,\n    uniforms: uniforms,\n    lights: true\n  })\n  let box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -10, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -20, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -30, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -40, 0)\n  scene.add(box)\n  box = new THREE.Mesh(new THREE.BoxBufferGeometry(10, 10, 10), m)\n  box.position.set(0, -50, 0)\n  scene.add(box)\n\n  particleSystem('clouds')\n\n  // projective texture mapping\n  let spotLight2 = new THREE.SpotLight(0xffff00, 0.3)\n  spotLight2.position.set(-70, 95, 100)\n  spotLight2.angle = Math.PI / 8\n  spotLight2.penumbra = 0.08\n  spotLight2.decay = 2\n  spotLight2.distance = 400\n  spotLight2.castShadow = true\n  spotLight2.shadow.mapSize.width = SHADOW_MAP_WIDTH\n  spotLight2.shadow.mapSize.height = SHADOW_MAP_HEIGHT\n  spotLight2.shadow.camera.near = 10\n  spotLight2.shadow.camera.far = 180\n\n  planeuniform = THREE.UniformsUtils.clone(shader.uniforms)\n  planeuniform[\"diffuse\"] = {\n    type: 'c',\n    value: new THREE.Color(0xffffff)\n  }\n  planeuniform[\"showMapTexture\"] = {\n    type: 'b',\n    value: true\n  }\n  planeuniform[\"blendingParam\"] = {\n    type: 'f',\n    value: 0.5\n  }\n  planeuniform[\"map\"] = {\n    value: backboardTex\n  }\n  planeuniform[\"mapProj\"] = {\n    \"type\": \"t\", \"value\": huajiTexture\n  };\n  planeuniform[\"textureMatrixProj\"] = {\n    \"type\": \"m4\",\n    \"value\": new THREE.Matrix4()\n  };\n  planeuniform[\"spotLightPosition\"] = {\n    value: spotLight2.position\n  }\n  planeuniform['spotLightColor'] = {\n    value: new THREE.Color(0xffffff)\n  }\n  let planegeo = new THREE.PlaneBufferGeometry(200, 200)\n  let planemtl = new THREE.ShaderMaterial({\n    fragmentShader: phong.frag,\n    vertexShader: phong.vert,\n    uniforms: planeuniform,\n    lights: true\n  })\n  let plane = new THREE.Mesh(planegeo, planemtl)\n  plane.position.set(-30, 0, -130)\n  scene.add(plane)\n\n  let targetObject = new THREE.Object3D()\n  targetObject.position.set(-50, 0, -130)\n  spotLight2.target = targetObject\n  targetObject.updateMatrixWorld()\n  scene.add(spotLight2)\n  scene.add(targetObject)\n\n  // let spotlightHelper = new THREE.SpotLightHelper(spotLight2)\n  // scene.add(spotlightHelper)\n  plane.material.uniforms.textureMatrixProj.value = makeProjectiveMatrixForLight(spotLight2)\n\n  initDepth()\n\n  window.addEventListener('resize', onWindowResize, false)\n\n  //mirror reflector\n  // var verticalMirror = new THREE.Reflector(400, 350, {\n  //   clipBias: 0.002,\n  //   textureWidth: SCREEN_WIDTH * window.devicePixelRatio,\n  //   textureHeight: SCREEN_HEIGHT * window.devicePixelRatio,\n  //   color: 0x889999,\n  //   recursion: 1\n  // })\n  // verticalMirror.position.y = 50\n  // verticalMirror.position.x = -260\n  // verticalMirror.position.z = -70\n  // verticalMirror.rotateY(Math.PI / 2)\n  // // verticalMirror.lookAtPosition.add(-camera.matrixWorld.position)\n  // scene.add(verticalMirror)\n}\n\nfunction onWindowResize() {\n  camera.aspect = window.innerWidth / window.innerHeight\n  camera.updateProjectionMatrix()\n  renderer.setSize(window.innerWidth, window.innerHeight)\n}\n\nvar lastTime = null\nfunction animate(time) {\n  if (!lastTime) {\n    lastTime = time\n  }\n  uniforms.time.value = time / 300\n  requestAnimationFrame(animate)\n  if (particleEngine) {\n    let delta = time - lastTime\n    particleEngine.update(delta / 1000)\n  }\n  lastTime = time\n  render()\n  if (renderDepthFlag) { renderer.render(postScene, postCamera) }\n}\n\nfunction render() {\n  if (renderDepthFlag) {\n    renderer.render(scene, camera, depthTarget)\n  } else {\n    renderer.render(scene, camera)\n  }\n}\n\nfunction makeProjectiveMatrixForLight(l) {\n  var lightCamera = new THREE.PerspectiveCamera(l.angle * 180 / Math.PI, 1.0, 1, 1000)\n  var lightMatrix = new THREE.Matrix4()\n  var targetPosition = new THREE.Vector3()\n\n  lightCamera.position.setFromMatrixPosition(l.matrixWorld)\n  targetPosition.setFromMatrixPosition(l.target.matrixWorld)\n  lightCamera.lookAt(targetPosition)\n  lightCamera.updateMatrixWorld()\n\n  lightCamera.matrixWorldInverse.getInverse(lightCamera.matrixWorld)\n\n  lightMatrix.set(\n    0.5, 0.0, 0.0, 0.5,\n    0.0, 0.5, 0.0, 0.5,\n    0.0, 0.0, 0.5, 0.5,\n    0.0, 0.0, 0.0, 1.0\n  )\n\n  lightMatrix.multiply(lightCamera.projectionMatrix)\n  lightMatrix.multiply(lightCamera.matrixWorldInverse)\n\n  return lightMatrix\n}\n\nfunction initGUI() {\n  // var API = {\n  //   'show directional light': true,\n  //   'show spot light': true,\n  //   'show ambient light': true\n  // }\n  // var gui = new dat.GUI()\n  // gui.add(API, 'show directional light').onChange(function () {\n  //   directionalLight.visible = API['show directional light']\n  // })\n  let gui = new dat.GUI({\n    width: '300px'\n  })\n\n  let folder = gui.addFolder(\"Miku\")\n  let shadingConf = {\n    'shading': 'smooth shading'\n  }\n  folder.add(shadingConf, 'shading', ['smooth shading', 'flat shading'])\n    .onChange((value) => {\n      miku.traverse((node) => {\n        if (node instanceof THREE.Mesh) {\n          if (value == 'flat shading') {\n            if (node.material instanceof THREE.MeshPhongMaterial) {\n              node.material.flatShading = true\n              node.material.needsUpdate = true\n            } else {\n              for (let k in node.material) {\n                node.material[k].flatShading = true\n                node.material[k].needsUpdate = true\n              }\n            }\n          } else {\n            if (node.material instanceof THREE.MeshPhongMaterial) {\n              node.material.flatShading = false\n              node.material.needsUpdate = true\n            } else {\n              for (let k in node.material) {\n                node.material[k].flatShading = false\n                node.material[k].needsUpdate = true\n              }\n            }\n          }\n        }\n      })\n    })\n\n  folder = gui.addFolder(\"Directional light\")\n  let directionalLightConf = {\n    visible: directionalLight.visible,\n    color: directionalLight.color.getStyle()\n  }\n  folder.add(directionalLightConf, 'visible').onChange(() => {\n    directionalLight.visible = directionalLightConf['visible']\n  })\n  folder.addColor(directionalLightConf, 'color').onChange((value) => {\n    directionalLight.color.setStyle(value)\n  })\n  // folder.open()\n\n  folder = gui.addFolder(\"Point light\")\n  let pointLightConf = {\n    visible: pointLight.visible,\n    color: pointLight.color.getStyle(),\n    castShadow: pointLight.castShadow\n  }\n  folder.add(pointLightConf, 'visible').onChange(() => {\n    pointLight.visible = pointLightConf['visible']\n  })\n  folder.addColor(pointLightConf, 'color').onChange((value) => {\n    pointLight.color.setStyle(value)\n  })\n  folder.add(pointLightConf, 'castShadow').onChange(() => {\n    pointLight.castShadow = pointLightConf['castShadow']\n  })\n  // folder.open()\n\n  folder = gui.addFolder(\"Spot light\")\n  let spotLightConf = {\n    visible: spotLight.visible,\n    color: spotLight.color.getStyle(),\n    castShadow: spotLight.castShadow\n  }\n  folder.add(spotLightConf, 'visible').onChange(() => {\n    spotLight.visible = spotLightConf['visible']\n  })\n  folder.addColor(spotLightConf, 'color').onChange((value) => {\n    spotLight.color.setStyle(value)\n  })\n  folder.add(spotLightConf, 'castShadow').onChange(() => {\n    spotLight.castShadow = spotLightConf['castShadow']\n  })\n  // folder.open()\n\n  folder = gui.addFolder(\"Projective texturing\")\n  let projectiveConf = {\n    showMapTexture: planeuniform.showMapTexture.value,\n    blendingParam: planeuniform.blendingParam.value\n  }\n  folder.add(projectiveConf, 'showMapTexture').onChange((v) => {\n    planeuniform.showMapTexture.value = v\n  })\n  folder.add(projectiveConf, 'blendingParam').min(0.0).max(1.0).step(0.1)\n    .onChange((v) => {\n      planeuniform.blendingParam.value = v\n    })\n\n  folder = gui.addFolder(\"Depth Buffer\")\n  let depthConf = {\n    'render depth': renderDepthFlag,\n    'camera near': depthuniform.cameraNear.value,\n    'camera far': depthuniform.cameraFar.value\n  }\n  folder.add(depthConf, 'render depth').onChange((v) => {\n    renderDepthFlag = v\n    if (v === false) {\n      camera.near = NEAR\n      camera.far = FAR\n      camera.updateProjectionMatrix()\n    }\n  })\n  folder.add(depthConf, 'camera near').min(1).max(100).step(1.0)\n    .onChange((v) => {\n      camera.near = v\n      camera.updateProjectionMatrix()\n    })\n  folder.add(depthConf, 'camera far').min(500).max(FAR).step(1.0)\n    .onChange((v) => {\n      camera.far = v\n      camera.updateProjectionMatrix()\n    })\n}\n\nfunction particleSystem(effectName) {\n  let example = new Examples()\n  let paras = example.getEffect(effectName)\n\n  if (!paras) {\n    console.error('[particle system] no parameters')\n  }\n\n  let path = paras.particleTexturePath\n  let loader = new THREE.TextureLoader()\n  loader.load('../images/smokeparticle.png',\n    (_texture) => {\n      paras.particleTexture = _texture\n      let group = new THREE.Group()\n      particleEngine = new ParticleEngine()\n      particleEngine.setValues(paras)\n      particleEngine.initialize()\n\n      group.add(particleEngine.particleMesh)\n      scene.add(group)\n    },\n    (xhr) => {\n      console.log(xhr.loaded / xhr.total + '% loaded ' + path)\n    },\n    (xhr) => {\n      console.warn('[ParticleEffectsMarker] an error happened while loading ' + path)\n    })\n}\n\nfunction initDepth() {\n  depthTarget = new THREE.WebGLRenderTarget(window.innerWidth, window.innerHeight)\n  depthTarget.texture.format = THREE.RGBFormat\n  depthTarget.texture.minFilter = THREE.NearestFilter\n  depthTarget.texture.magFilter = THREE.NearestFilter\n  depthTarget.texture.generateMipmaps = false\n  depthTarget.stencilBuffer = false\n  depthTarget.depthBuffer = true\n  depthTarget.depthTexture = new THREE.DepthTexture()\n  depthTarget.depthTexture.type = THREE.UnsignedShortType\n\n  postCamera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1)\n  depthuniform = {\n    cameraNear: { value: camera.near },\n    cameraFar: { value: camera.far },\n    tDiffuse: { value: depthTarget.texture },\n    tDepth: { value: depthTarget.depthTexture }\n  }\n  var postMaterial = new THREE.ShaderMaterial({\n    vertexShader: depthShader.vert,\n    fragmentShader: depthShader.frag,\n    uniforms: depthuniform\n  })\n  var postPlane = new THREE.PlaneBufferGeometry(2, 2)\n  var postQuad = new THREE.Mesh(postPlane, postMaterial)\n  postScene = new THREE.Scene()\n  postScene.add(postQuad)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","var phong = {}\n\nphong.frag = `\n#define PHONG\n#define USE_MAP\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool showMapTexture;\nuniform float time;\nuniform sampler2D mapProj;\nvarying vec4 texCoordProj;\nvarying vec3 vNormalProj;\nvarying vec3 vViewPositionProj;\nuniform vec3 spotLightPosition;\nuniform vec3 spotLightColor;\nuniform float blendingParam;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n  #ifdef USE_MAP\n    if (showMapTexture) {\n\t\t\tvec2 transformedvUv = vec2(vUv);\n\t\t\ttransformedvUv.x = mod(transformedvUv.x + time, 1.0);\n      vec4 texelColor = texture2D( map, transformedvUv );\n      texelColor = mapTexelToLinear( texelColor );\n      diffuseColor *= texelColor;\n    }\n  #endif\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#ifdef USE_MAP\n\t\tif (showMapTexture) {\n\t\t\toutgoingLight = outgoingLight * blendingParam + diffuseColor.xyz * (1.0 - blendingParam);\n\t\t}\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\tvec4 texColorProj = texCoordProj.q < 0.0 ? vec4(0.0, 0.0, 0.0, 0.0) : texture2DProj( mapProj, texCoordProj); // for projective texturing\n\n\tgl_FragColor.xyz += texColorProj.xyz;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n`\n\nphong.vert = `\n#define PHONG\n#define USE_MAP\nvarying vec3 vViewPosition;\nuniform mat4 textureMatrixProj;\nvarying vec4 texCoordProj;\nvarying vec3 vNormalProj;\nvarying vec3 vViewPositionProj;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\t#endif\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\ttexCoordProj = textureMatrixProj * modelMatrix * vec4(position, 1.0);\n\tvNormalProj = normalMatrix * normal;\n\tvNormalProj = normalize(vNormalProj);\n\tvViewPositionProj = -(modelMatrix * vec4(position, 1.0)).xyz;\n}\n`\n\nexport default phong\n\n\n// WEBPACK FOOTER //\n// ./src/shaders/phong.js","import { Tween, Type } from './ParticleEngine.js'\n/**\n* @author Lee Stemkoski   http://www.adelphi.edu/~stemkoski/\n*/\n\n/*\n  Particle Engine options:\n\n  positionBase   : new THREE.THREE.Vector3(),\n  positionStyle : Type.CUBE or Type.SPHERE,\n\n  // for Type.CUBE\n  positionSpread  : new THREE.THREE.Vector3(),\n\n  // for Type.SPHERE\n  positionRadius  : 10,\n\n  velocityStyle : Type.CUBE or Type.SPHERE,\n\n  // for Type.CUBE\n  velocityBase       : new THREE.THREE.Vector3(),\n  velocitySpread     : new THREE.THREE.Vector3(),\n\n  // for Type.SPHERE\n  speedBase   : 20,\n  speedSpread : 10,\n\n  accelerationBase   : new THREE.THREE.Vector3(),\n  accelerationSpread : new THREE.THREE.Vector3(),\n\n  particleTexture : THREE.ImageUtils.loadTexture( 'images/star.png' ),\n\n  // rotation of image used for particles\n  angleBase               : 0,\n  angleSpread             : 0,\n  angleVelocityBase       : 0,\n  angleVelocitySpread     : 0,\n  angleAccelerationBase   : 0,\n  angleAccelerationSpread : 0,\n\n  // size, color, opacity\n  //   for static  values, use base/spread\n  //   for dynamic values, use Tween\n  //   (non-empty Tween takes precedence)\n  sizeBase   : 20.0,\n  sizeSpread : 5.0,\n  sizeTween  : new Tween( [0, 1], [1, 20] ),\n\n  // colors stored in THREE.Vector3 in H,S,L format\n  colorBase   : new THREE.THREE.Vector3(0.0, 1.0, 0.5),\n  colorSpread : new THREE.THREE.Vector3(0,0,0),\n  colorTween  : new Tween( [0.5, 2], [ new THREE.THREE.Vector3(0, 1, 0.5), new THREE.THREE.Vector3(1, 1, 0.5) ] ),\n\n  opacityBase   : 1,\n  opacitySpread : 0,\n  opacityTween  : new Tween( [2, 3], [1, 0] ),\n\n  blendStyle    : THREE.NormalBlending (default), THREE.AdditiveBlending\n\n  particlesPerSecond : 200,\n  particleDeathAge   : 2.0,\n  emitterDeathAge    : 60\n*/\n\n/*\nvar initExamples = {\n  // Not just any fountain -- a RAINBOW STAR FOUNTAIN of AWESOMENESS\n  fountain:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new THREE.Vector3(0, 5, 0),\n    positionSpread: new THREE.Vector3(10, 0, 10),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new THREE.Vector3(0, 160, 0),\n    velocitySpread: new THREE.Vector3(100, 20, 100),\n\n    accelerationBase: new THREE.Vector3(0, -100, 0),\n\n    particleTexture: null,\n    particleTexturePath: '../images/star.png',\n\n    angleBase: 0,\n    angleSpread: 180,\n    angleVelocityBase: 0,\n    angleVelocitySpread: 360 * 4,\n\n    sizeTween: new Tween([0, 1], [1, 20]),\n    opacityTween: new Tween([2, 3], [1, 0]),\n    colorTween: new Tween([0.5, 2], [new THREE.Vector3(0, 1, 0.5), new THREE.Vector3(0.8, 1, 0.5)]),\n\n    particlesPerSecond: 200,\n    particleDeathAge: 3.0,\n    emitterDeathAge: 60\n  },\n\n  fireball:\n  {\n    positionStyle: Type.SPHERE,\n    positionBase: new THREE.Vector3(0, 50, 0),\n    positionRadius: 2,\n\n    velocityStyle: Type.SPHERE,\n    speedBase: 40,\n    speedSpread: 8,\n\n    particleTexture: null,\n    particleTexturePath: '../images/smokeparticle.png',\n\n    sizeTween: new Tween([0, 0.1], [1, 150]),\n    opacityTween: new Tween([0.7, 1], [1, 0]),\n    colorBase: new Vector3(0.02, 1, 0.4),\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 60,\n    particleDeathAge: 1.5,\n    emitterDeathAge: 60\n  },\n\n  starfield:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 200, 0),\n    positionSpread: new Vector3(600, 400, 600),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 0, 0),\n    velocitySpread: new Vector3(0.5, 0.5, 0.5),\n\n    angleBase: 0,\n    angleSpread: 720,\n    angleVelocityBase: 0,\n    angleVelocitySpread: 4,\n\n    particleTexture: null,\n    particleTexturePath: '../images/spikey.png',\n\n    sizeBase: 10.0,\n    sizeSpread: 2.0,\n    colorBase: new Vector3(0.15, 1.0, 0.9), // H,S,L\n    colorSpread: new Vector3(0.00, 0.0, 0.2),\n    opacityBase: 1,\n\n    particlesPerSecond: 20000,\n    particleDeathAge: 60.0,\n    emitterDeathAge: 0.1\n  },\n\n  fireflies:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 100, 0),\n    positionSpread: new Vector3(400, 200, 400),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 0, 0),\n    velocitySpread: new Vector3(60, 20, 60),\n\n    particleTexture: null,\n    particleTexturePath: '../images/spark.png',\n\n    sizeBase: 30.0,\n    sizeSpread: 2.0,\n    opacityTween: new Tween([0.0, 1.0, 1.1, 2.0, 2.1, 3.0, 3.1, 4.0, 4.1, 5.0, 5.1, 6.0, 6.1],\n      [0.2, 0.2, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 0.2, 0.2, 1.0, 1.0, 0.2]),\n    colorBase: new Vector3(0.30, 1.0, 0.6), // H,S,L\n    colorSpread: new Vector3(0.3, 0.0, 0.0),\n\n    particlesPerSecond: 20,\n    particleDeathAge: 6.1,\n    emitterDeathAge: 600\n  },\n\n  startunnel:\n  {\n    positionStyle: Type.CUBE,\n    positionBase: new Vector3(0, 0, 0),\n    positionSpread: new Vector3(10, 10, 10),\n\n    velocityStyle: Type.CUBE,\n    velocityBase: new Vector3(0, 100, 200),\n    velocitySpread: new Vector3(40, 40, 80),\n\n    angleBase: 0,\n    angleSpread: 720,\n    angleVelocityBase: 10,\n    angleVelocitySpread: 0,\n\n    particleTexture: null,\n    particleTexturePath: '../images/spikey.png',\n\n    sizeBase: 4.0,\n    sizeSpread: 2.0,\n    colorBase: new Vector3(0.15, 1.0, 0.8), // H,S,L\n    opacityBase: 1,\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 500,\n    particleDeathAge: 4.0,\n    emitterDeathAge: 60\n  },\n\n  firework:\n  {\n    positionStyle: Type.SPHERE,\n    positionBase: new Vector3(0, 100, 0),\n    positionRadius: 10,\n\n    velocityStyle: Type.SPHERE,\n    speedBase: 90,\n    speedSpread: 10,\n\n    accelerationBase: new Vector3(0, -80, 0),\n\n    particleTexture: null,\n    particleTexturePath: '../images/spark.png',\n\n    sizeTween: new Tween([0.5, 0.7, 1.3], [5, 40, 1]),\n    opacityTween: new Tween([0.2, 0.7, 2.5], [0.75, 1, 0]),\n    colorTween: new Tween([0.4, 0.8, 1.0], [new Vector3(0, 1, 1), new Vector3(0, 1, 0.6), new Vector3(0.8, 1, 0.6)]),\n    blendStyle: AdditiveBlending,\n\n    particlesPerSecond: 3000,\n    particleDeathAge: 2.5,\n    emitterDeathAge: 0.2\n  }\n} */\n\nvar examples =\n  {\n    // parameters above remain the same, to be modified\n    // effects below are modified for examples in earth. exmaples/qh-8-add-particles/debug.html\n    smoke:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(2, 2, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, 10),\n      velocitySpread: new THREE.Vector3(5, 5, 5),\n      accelerationBase: new THREE.Vector3(0, 0, -1),\n\n      particleTexture: null,\n      particleTexturePath: '../images/smokeparticle.png',\n\n      angleBase: 0,\n      angleSpread: 720,\n      angleVelocityBase: 0,\n      angleVelocitySpread: 720,\n\n      sizeTween: new Tween([0, 1], [32, 128]),\n      opacityTween: new Tween([0.8, 2], [0.5, 0]),\n      colorTween: new Tween([0.4, 1], [new THREE.Vector3(0, 0, 0.2), new THREE.Vector3(0, 0, 0.5)]),\n\n      particlesPerSecond: 400,\n      particleDeathAge: 2.0,\n      emitterDeathAge: 60\n    },\n\n    clouds:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(200, 200, 10),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0.4, 0, 0),\n      velocitySpread: new THREE.Vector3(0.2, 0, 0),\n\n      particleTexture: null,\n      particleTexturePath: '../../images/smokeparticle.png',\n\n      sizeBase: 40.0,\n      sizeSpread: 40.0,\n      colorBase: new THREE.Vector3(0.0, 0.0, 1.0), // H,S,L\n      opacityTween: new Tween([0, 1, 4, 5], [0, 1, 1, 0]),\n\n      particlesPerSecond: 20,\n      particleDeathAge: 4.0,\n      emitterDeathAge: 60\n    },\n\n    snow:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(5, 5, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, -1),\n      velocitySpread: new THREE.Vector3(1, 1, 0.5),\n      accelerationBase: new THREE.Vector3(0, 0, -0.5),\n\n      angleBase: 0,\n      angleSpread: 720,\n      angleVelocityBase: 0,\n      angleVelocitySpread: 60,\n\n      particleTexture: null,\n      particleTexturePath: '../images/snowflake.png',\n\n      sizeTween: new Tween([0, 0.25], [40, 80]),\n      colorBase: new THREE.Vector3(0.66, 1.0, 0.9), // H,S,L\n      opacityTween: new Tween([2, 3], [0.8, 0]),\n\n      particlesPerSecond: 20,\n      particleDeathAge: 4.0,\n      emitterDeathAge: 60\n    },\n\n    rain:\n    {\n      positionStyle: Type.CUBE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionSpread: new THREE.Vector3(5, 5, 0),\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, -3),\n      velocitySpread: new THREE.Vector3(1, 1, 2),\n      accelerationBase: new THREE.Vector3(0, 0, -2),\n\n      particleTexture: null,\n      particleTexturePath: '../images/raindrop2flip.png',\n\n      sizeBase: 60.0,\n      sizeSpread: 30.0,\n      colorBase: new THREE.Vector3(0.67, 1.0, 0.4), // H,S,L\n      colorSpread: new THREE.Vector3(0.00, 0.0, 0.2),\n      opacityBase: 0.6,\n\n      particlesPerSecond: 40,\n      particleDeathAge: 1.5,\n      emitterDeathAge: 60\n    },\n\n    candle:\n    {\n      positionStyle: Type.SPHERE,\n      positionBase: new THREE.Vector3(0, 0, 0),\n      positionRadius: 1,\n\n      velocityStyle: Type.CUBE,\n      velocityBase: new THREE.Vector3(0, 0, 7),\n      velocitySpread: new THREE.Vector3(2, 2, 0),\n\n      particleTexture: null,\n      particleTexturePath: '../images/smokeparticle.png',\n\n      sizeTween: new Tween([0, 0.3, 1.2], [20, 150, 1]),\n      opacityTween: new Tween([0.9, 1.5], [1, 0]),\n      colorTween: new Tween([0.5, 1.0], [new THREE.Vector3(0.02, 1, 0.5), new THREE.Vector3(0.05, 1, 0)]),\n      blendStyle: THREE.AdditiveBlending,\n\n      particlesPerSecond: 600,\n      particleDeathAge: 12,\n      emitterDeathAge: 60\n    }\n\n  }\n\nfunction cloneExamples (examples) {\n  let dst = {}\n  for (let key in examples) {\n    dst[key] = {}\n    for (let u in examples[key]) {\n      if (examples[key][u] instanceof THREE.Vector3) {\n        dst[key][u] = examples[key][u].clone()\n      } else if (examples[key][u] instanceof Tween) {\n        dst[key][u] = examples[key][u].clone()\n      } else if (examples[key][u] instanceof Array) {\n        dst[key][u] = examples[key][u].slice()\n      } else if (examples[key][u] instanceof String) {\n        dst[key][u] = examples[key][u]\n      } else if (examples[key][u] instanceof Number) {\n        dst[key][u] = examples[key][u]\n      } else {\n        dst[key][u] = examples[key][u]\n      }\n    }\n  }\n  return dst\n}\n\nclass Examples {\n  constructor () {\n    this.examples = cloneExamples(examples)\n  }\n\n  exist (effect) {\n    if (this.examples[effect]) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  getEffect (effect) {\n    return this.examples[effect]\n  }\n\n  destruct () {\n    for (let key in this.examples) {\n      if (this.examples[key].particleTexture) {\n        this.examples[key].particleTexture.dispose()\n        this.examples[key].particleTexture = null\n      }\n    }\n  }\n}\n\nexport { Examples }\n\n\n\n// WEBPACK FOOTER //\n// ./src/ParticleEngine/ParticleEngineExamples.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/util.js\n// module id = 4\n// module chunks = 0","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 5\n// module chunks = 0","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/process/browser.js\n// module id = 6\n// module chunks = 0","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/support/isBufferBrowser.js\n// module id = 7\n// module chunks = 0","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/util/node_modules/inherits/inherits_browser.js\n// module id = 8\n// module chunks = 0","var depthShader = {}\r\n\r\ndepthShader.vert = `\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}\r\n`\r\n\r\ndepthShader.frag = `\r\n#include <packing>\r\nvarying vec2 vUv;\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D tDepth;\r\nuniform float cameraNear;\r\nuniform float cameraFar;\r\n\r\nfloat readDepth (sampler2D depthSampler, vec2 coord) {\r\n  float fragCoordZ = texture2D(depthSampler, coord).x;\r\n  float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );\r\n  return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\r\n}\r\n\r\nfloat remap( float minval, float maxval, float curval )\r\n{\r\n    return ( curval - minval ) / ( maxval - minval );\r\n}\r\n\r\nvoid main() {\r\n  // vec3 diffuse = texture2D(tDiffuse, vUv).rgb;\r\n  float depth = readDepth(tDepth, vUv);\r\n\r\n  const vec4 GREEN = vec4( 0.0, 1.0, 0.0, 1.0 );\r\n  const vec4 BLUE = vec4( 0.0, 0.0, 1.0, 1.0 );\r\n  const vec4 RED   = vec4( 1.0, 0.0, 0.0, 1.0 );\r\n\r\n  if( depth < 0.5 )\r\n    gl_FragColor = mix( GREEN, BLUE, remap( 0.0, 0.5, depth ) );\r\n  else\r\n    gl_FragColor = mix( BLUE, RED, remap( 0.5, 1.0, depth ) );\r\n  // gl_FragColor.rgb = vec3(depth);\r\n  // gl_FragColor.a = 1.0;\r\n}\r\n`\r\n\r\nexport default depthShader;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shaders/depth.js"],"sourceRoot":""}
>>>>>>> 78ff130aa23d274f4d41d8142c46c271173ea831
